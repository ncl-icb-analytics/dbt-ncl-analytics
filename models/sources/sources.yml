version: 2
# Manual sources configuration
# - Sources NOT in source_mappings.yml: Fully manual sources (e.g. 'aic')
#   These must have database/schema defined here as they won't be auto-generated
# 
# IMPORTANT: For sources IN source_mappings.yml, define manual table overrides below
# using the 'manual_table_overrides' key. These will be automatically merged into
# the auto-generated files during source generation, so they won't appear as duplicates.

sources:
# Manual table definitions for sources that ARE in source_mappings.yml
# These are merged into auto-generated files by 2_generate_sources.py
# Format: source_name: {table_name: table_definition}
# Example structure (commented out - uncomment and modify as needed):
# - source_name: c_ltcs
#   tables:
#   - name: MDT_LOOKUP
#     identifier: MDT_LOOKUP
#     columns:
#     - name: PCN_CODE
#       data_type: TEXT
#     - name: DATE
#       data_type: DATE

# Fully manual source (NOT in source_mappings.yml)
- name: aic
  database: '"DATA_LAKE__NCL"'
  schema: '"AIC_DEV"'
  description: AIC pipelines
  tables:
  - name: BASE_ATHENA__CONCEPT
    identifier: '"BASE_ATHENA__CONCEPT"'
    columns:
    - name: CONCEPT_ID
      data_type: NUMBER
    - name: CONCEPT_NAME
      data_type: TEXT
    - name: DOMAIN_ID
      data_type: TEXT
    - name: VOCABULARY_ID
      data_type: TEXT
    - name: CONCEPT_CLASS_ID
      data_type: TEXT
    - name: STANDARD_CONCEPT
      data_type: TEXT
    - name: CONCEPT_CODE
      data_type: TEXT
    - name: VALID_START_DATE
      data_type: DATE
    - name: VALID_END_DATE
      data_type: DATE
    - name: INVALID_REASON
      data_type: TEXT
  - name: BASE_CCMS_DMD_CODES
    identifier: '"BASE_CCMS_DMD_CODES"'
    columns:
    - name: CONDITIONID
      data_type: NUMBER
    - name: CONDITIONNAME
      data_type: TEXT
    - name: PRODUCTID
      data_type: NUMBER
    - name: PRIMARYTERM
      data_type: TEXT
  - name: BASE_CCMS_SNOMED_CODES
    identifier: '"BASE_CCMS_SNOMED_CODES"'
    columns:
    - name: CONDITIONID
      data_type: NUMBER
    - name: CONDITIONNAME
      data_type: TEXT
    - name: CONCEPTID
      data_type: NUMBER
    - name: PRIMARYTERM
      data_type: TEXT
  - name: BASE_GOV__IMD_2019
    identifier: '"BASE_GOV__IMD_2019"'
    columns:
    - name: LSOA_CODE_2011
      data_type: TEXT
    - name: LSOA_NAME_2011
      data_type: TEXT
    - name: LA_CODE_2019
      data_type: TEXT
    - name: LA_NAME_2019
      data_type: TEXT
    - name: IMD_RANK
      data_type: NUMBER
    - name: IMD_DECILE
      data_type: NUMBER
  - name: BASE_GOV__WARD_NAMES
    identifier: '"BASE_GOV__WARD_NAMES"'
    columns:
    - name: WARD_CODE
      data_type: TEXT
    - name: WARD_NAME
      data_type: TEXT
  - name: BASE_NHSBSA__APID_VPID
    identifier: '"BASE_NHSBSA__APID_VPID"'
    columns:
    - name: APID
      data_type: NUMBER
    - name: VPID
      data_type: NUMBER

# Manual table overrides for sources IN source_mappings.yml
# These are stored under 'manual_table_overrides' (not 'sources') so dbt doesn't see them as duplicate sources
# The script automatically merges these into the auto-generated files during generation
manual_table_overrides:
- source_name: reference_lookup_ncl
  tables:
  - name: NCL_PROVIDER
    identifier: '"NCL_PROVIDER"'
    columns:
    - name: SK_ORGANISATION_ID
      data_type: NUMBER
    - name: PROVIDER_CODE
      data_type: TEXT
    - name: PROVIDER_NAME
      data_type: TEXT
    - name: PROVIDER_SHORTHAND
      data_type: TEXT
    - name: REPORTING_CODE
      data_type: TEXT
    - name: REPORTING_NAME
      data_type: TEXT
    - name: REPORTING_SHORTHAND
      data_type: TEXT
    - name: PROVIDER_TYPE
      data_type: TEXT
    - name: ROW_TYPE
      data_type: TEXT

- source_name: c_ltcs
  tables:
  - name: 'MDT_LOOKUP'
    identifier: 'MDT_LOOKUP'
    columns:
    - name: PCN_CODE
      data_type: TEXT
    - name: DATE
      data_type: DATE
  - name: 'STATUS_LOG'
    identifier: 'STATUS_LOG'
    columns:
    - name: PATIENT_ID
      data_type: NUMBER
    - name: PCN_CODE
      data_type: TEXT
    - name: DATE
      data_type: DATE
    - name: ACTION
      data_type: TEXT
    - name: ACTION_DATE
      data_type: TIMESTAMP_TZ
    - name: CRITERIA
      data_type: TEXT
  - name: 'OP_OE_RATIO'
    identifier: 'OP_OE_RATIO'
    columns:
    - name: PATIENT_ID
      data_type: NUMBER
    - name: OE_RATIO
      data_type: NUMBER
    - name: PREDICTED
      data_type: NUMBER
    - name: OP_ATT_TOT_12MO
      data_type: NUMBER

