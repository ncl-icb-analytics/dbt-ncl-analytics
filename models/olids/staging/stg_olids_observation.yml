version: 2
models:
- name: stg_olids_observation
  description: Clinical observations including test results, vital signs, and diagnoses.
    Deduplicated by id - note that deleted records are not filtered as lds_is_deleted
    is not used in this table.
  columns:
  - name: id
    description: Primary key - unique identifier for this observation
    tests:
    - unique
    - not_null
  - name: patient_id
    description: Foreign key to patient.id
  - name: person_id
    description: Foreign key to person.id - person-level identifier
  - name: encounter_id
    description: Foreign key to encounter.id - encounter when observation was made
  - name: practitioner_id
    description: Foreign key to practitioner.id - practitioner who made the observation
  - name: parent_observation_id
    description: Foreign key to observation.id - parent observation if this is a sub-observation
  - name: clinical_effective_date
    description: Date the observation was clinically effective
  - name: date_precision_concept_id
    description: Foreign key to concept.id - precision of the clinical effective date
  - name: result_value
    description: Numeric result value of the observation
  - name: result_value_unit_concept_id
    description: Foreign key to concept.id - unit of measure for the result value
  - name: result_date
    description: Date the result was obtained
  - name: result_text
    description: Text description of the result
  - name: is_problem
    description: Boolean indicating if this observation represents a problem
  - name: is_review
    description: Boolean indicating if this is a review record
  - name: problem_end_date
    description: Date the problem ended, if applicable
  - name: observation_source_concept_id
    description: Foreign key to concept.id - source concept for the observation type
  - name: age_at_event
    description: Patient age in years at time of observation
  - name: age_at_event_baby
    description: Patient age in months for babies (0-24 months)
  - name: age_at_event_neonate
    description: Patient age in days for neonates (0-28 days)
  - name: episodicity_concept_id
    description: Foreign key to concept.id - episodicity classification (first, new,
      review)
  - name: is_primary
    description: Boolean indicating if this is the primary observation
  - name: date_recorded
    description: Date the record was entered into the system
  - name: is_deleted
    description: Boolean indicating if the clinical record has been deleted
  - name: is_problem_deleted
    description: Boolean indicating if the associated problem has been deleted
  - name: is_confidential
    description: Boolean indicating if the record is marked as confidential
  - name: lds_id
    description: LDS system identifier
  - name: record_owner_organisation_code
    description: Organisation code of the record owner
  - name: lds_datetime_data_acquired
    description: Datetime when data was acquired by LDS
  - name: lds_initial_data_received_date
    description: Date when data was initially received by LDS
  - name: mapped_concept_id
    description: Foreign key to concept.id - mapped standardized concept
  - name: mapped_concept_code
    description: Code of the mapped concept
  - name: mapped_concept_display
    description: Display text of the mapped concept
  - name: result_unit_code
    description: Code for the result unit
  - name: result_unit_display
    description: Display text for the result unit
  - name: lds_start_date_time
    description: LDS datetime stamp from which the record version was correct - used
      for deduplication to get the latest record
  - name: lds_record_id
    description: LDS assigned unique identifier for the source record version
  tests:
  - dbt_expectations.expect_table_row_count_to_be_between:
      min_value: 1
