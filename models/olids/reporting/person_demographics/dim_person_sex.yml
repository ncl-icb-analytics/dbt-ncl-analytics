version: 2
models:
  - name: dim_person_sex
    description: 'Sex demographics for all persons with standardised three-category classification.

      Key Features:

      • One row per person derived from gender_concept_id mappings

      • Standardised categories: Male, Female, Unknown

      • Patient selection prioritises records with gender data

      • Fallback to current registration patient for coverage

      • Deduplication ensures single row per person

      Purpose: Supports demographic analysis, clinical safety screening, and population health assessment.'
    
    columns:
      - name: person_id
        description: 'Unique identifier for the person'
        tests:
          - not_null
          - unique
      
      - name: sex
        description: 'Persons sex derived from gender concept mappings (Male, Female, or Unknown)'
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Male', 'Female', 'Unknown']

