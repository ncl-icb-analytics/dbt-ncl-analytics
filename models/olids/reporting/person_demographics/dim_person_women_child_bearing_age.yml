version: 2
models:
  - name: dim_person_women_child_bearing_age
    description: 'Individuals of child-bearing age for clinical safety and population health analysis.

      Key Features:

      • Includes persons who are not male (Female or Unknown sex) aged 55 or younger

      • Two age range definitions: 12-55 (standard demographic) and 0-55 (clinical safety programmes)

      • "Not male" approach for inclusive clinical safety (broader than Female-only)

      • Used for medication safety programmes like Valproate monitoring

      Purpose: Supports clinical safety screening, contraception analysis, and reproductive health population identification.'

    columns:
      - name: person_id
        description: 'Unique identifier for the person'
        tests:
          - not_null
          - unique

      - name: age
        description: 'Current age (or age at death) in years'
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 55

      - name: sex
        description: 'Sex (Female or Unknown - excludes Male by definition)'
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Female', 'Unknown']

      - name: is_child_bearing_age_12_55
        description: 'Flag for standard demographic child-bearing age (12-55 years inclusive)'
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: [true, false]

      - name: is_child_bearing_age_0_55
        description: 'Flag for clinical safety child-bearing age (0-55 years inclusive) - always TRUE for records in this table'
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: [true]
