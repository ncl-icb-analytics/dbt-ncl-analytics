version: 2
models:
  - name: dim_ltc_lcs_cf_af_61
    description: 'Atrial fibrillation case finding for patients on cardiac medications who may have undiagnosed AF.

      One row per person on anticoagulants, AF drugs, digoxin, cardiac glycosides, or protamine drugs (excludes DVT and existing AF/flutter diagnoses).'
    
    config:
      meta:
        indicator:
          id: "LTC_LCS_CF_AF_61"
          type: "CASE_FINDING"
          category: "AF"
          clinical_domain: "Cardiovascular Case Finding"
          name_short: "On cardiac medication"
          description_short: "Patients on cardiac medications without AF diagnosis"
          description_long: >
            On anticoagulants, AF drugs, digoxin, cardiac glycosides, or protamine drugs without AF diagnosis.
            Uses differential time windows: 6 months for anticoagulants/protamine, 3 months for other medications.
            Excludes DVT, atrial flutter, existing AF/flutter diagnoses.
          is_qof: false
          source_column: "person_id"
          sort_order: "LTC_LCS_AF_61"
          usage_contexts:
            - "LTC_LCS_DASHBOARD"
            - "CASE_FINDING_PROGRAMME"
          code_clusters:
            - cluster_id: "ORANTICOAG_2.8.2"
              category: "INCLUSION"
              time_window: "6_MONTHS"
            - cluster_id: "DRUGS_USED_IN_AF"
              category: "INCLUSION"
              time_window: "3_MONTHS"
            - cluster_id: "DIGOXIN"
              category: "INCLUSION"
              time_window: "3_MONTHS"
            - cluster_id: "CARDIAC_GLYCOSIDES"
              category: "INCLUSION"
              time_window: "3_MONTHS"
            - cluster_id: "PROTAMINE_DRUGS"
              category: "INCLUSION"
              time_window: "6_MONTHS"
            - cluster_id: "DVT"
              category: "EXCLUSION"
            - cluster_id: "AF_FLUTTER"
              category: "EXCLUSION"
            - cluster_id: "ATRIAL_FIBRILLATION_61_EXCLUSIONS"
              category: "EXCLUSION"
          thresholds:
            - population_group: "ADULTS"
              threshold_type: "MEDICATION_PRESENCE"
              threshold_value: "ANY"
              threshold_operator: "EQUALS"
              threshold_unit: "boolean"
              description: "Any cardiac medication prescription"
              sort_order: 1
