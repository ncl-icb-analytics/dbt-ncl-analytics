models:
  - name: dq_blood_pressure_issues
    description: 'Data quality issues in blood pressure measurements requiring clinical review or data correction.

      Issue Types:

      • Out-of-range values (systolic <40 or >350 mmHg, diastolic <20 or >200 mmHg)

      • Coding ambiguity (generic BP codes without specific systolic/diastolic flags)

      • Orphaned readings (systolic without diastolic or vice versa)

      • Missing dates

      Purpose: Supports clinical data validation and quality improvement processes.'
    
    columns:
      - name: person_id
        description: Unique person identifier
        
      - name: clinical_effective_date
        description: Date of blood pressure measurement (may be NULL)
        
      - name: systolic_value_original
        description: Original systolic value before quality filtering
        
      - name: diastolic_value_original
        description: Original diastolic value before quality filtering
        
      - name: result_unit_display
        description: Unit of measurement (mmHg)
        
      - name: all_concept_codes
        description: All concept codes associated with this measurement
        
      - name: all_concept_displays
        description: All concept display names for this measurement
        
      - name: all_source_cluster_ids
        description: All source cluster IDs for this measurement
        
      - name: is_sbp_out_of_range
        description: Whether systolic BP is out of range (<40 or >350 mmHg)
        
      - name: is_dbp_out_of_range
        description: Whether diastolic BP is out of range (<20 or >200 mmHg)
        
      - name: is_coding_ambiguous
        description: Whether BP coding is ambiguous (generic BP_COD without specific codes)
        
      - name: is_orphaned_reading
        description: Whether reading is orphaned (systolic without diastolic or vice versa)
        
      - name: is_date_missing
        description: Whether clinical effective date is missing
    
    tests:
      - cluster_ids_exist:
          arguments:
            cluster_ids: ABPM_COD, BP_COD, DIASBP_COD, HOMEAMBBP_COD, HOMEBP_COD, SYSBP_COD
