version: 2
models:
  - name: int_stroke_tia_diagnoses_all
    description: 'Stroke and TIA diagnosis observations for QOF register data collection and cerebrovascular secondary prevention.

      One row per stroke or TIA diagnosis observation using STRK_COD and TIA_COD clusters with permanent cardiovascular event tracking and no age restrictions.'
    columns:
      - name: id
        description: 'Unique identifier for the clinical observation'

      - name: person_id
        description: 'Patient identifier'

      - name: clinical_effective_date
        description: 'Date when stroke or TIA diagnosis was clinically effective'

      - name: concept_code
        description: 'Clinical code for stroke or TIA diagnosis'

      - name: concept_display
        description: 'Human-readable description of the clinical code'

      - name: source_cluster_id
        description: 'QOF cluster identifier (STRK_COD or TIA_COD)'

      - name: is_stroke_diagnosis_code
        description: 'Flag indicating stroke diagnosis code (STRK_COD cluster)'

      - name: is_tia_diagnosis_code
        description: 'Flag indicating TIA diagnosis code (TIA_COD cluster)'

      - name: is_diagnosis_code
        description: 'Flag indicating any stroke or TIA diagnosis code'

      - name: stroke_tia_observation_type
        description: 'Categorised stroke/TIA observation type (Stroke Diagnosis or TIA Diagnosis)'

    tests:
      - cluster_ids_exist:
          cluster_ids: STRK_COD, TIA_COD
