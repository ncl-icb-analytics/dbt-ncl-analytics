version: 2
models:
  - name: int_asthma_diagnoses_all
    description: 'Asthma diagnosis and resolution observations for QOF register management.

      Key Features:

      • Uses AST_COD cluster for diagnosis codes

      • Uses ASTRES_COD cluster for resolution codes

      • Supports QOF respiratory disease management

      • Enables childhood and adult asthma tracking

      • Age restrictions (typically 6+ years) applied in fact layer

      Purpose: Provide observation-level data for asthma register inclusion and respiratory care pathway monitoring.'
    tests:
      - cluster_ids_exist:
          arguments:
            cluster_ids: AST_COD, ASTRES_COD
    columns:
      - name: id
        description: 'Unique identifier for the clinical observation'
      - name: person_id
        description: 'Unique identifier for the person'
      - name: clinical_effective_date
        description: 'Date when the asthma observation was recorded'
      - name: concept_code
        description: 'Clinical code for asthma diagnosis or resolution'
      - name: concept_display
        description: 'Human-readable description of the asthma concept'
      - name: source_cluster_id
        description: 'Source cluster identifier (AST_COD for diagnosis, ASTRES_COD for resolution)'
      - name: is_diagnosis_code
        description: 'Boolean flag indicating if the code represents an asthma diagnosis (TRUE for AST_COD cluster)'
      - name: is_resolved_code
        description: 'Boolean flag indicating if the code represents asthma resolution (TRUE for ASTRES_COD cluster)'
