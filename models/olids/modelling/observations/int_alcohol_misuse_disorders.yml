version: 2

models:
  - name: int_alcohol_misuse_disorders
    description: 'Alcohol misuse, abuse, and dependence diagnoses for addiction services planning.

      One row per alcohol disorder observation using ALCOHOL_MISUSE_DISORDERS cluster with disorder categorisation and severity assessment.'

    tests:
      - cluster_ids_exist:
          arguments:
            cluster_ids: ALCOHOL_MISUSE_DISORDERS

    columns:
      - name: person_id
        description: Unique identifier for the person
        tests:
          - not_null

      - name: id
        description: Unique identifier for each alcohol disorder observation
        tests:
          - unique
          - not_null

      - name: clinical_effective_date
        description: Date when the diagnosis was recorded
        tests:
          - not_null

      - name: concept_code
        description: SNOMED concept code for the alcohol disorder

      - name: concept_display
        description: Display text for the alcohol disorder concept

      - name: source_cluster_id
        description: Source cluster identifier (ALCOHOL_MISUSE_DISORDERS)

      - name: result_value
        description: Numeric result value if applicable

      - name: result_text
        description: Text result or additional notes

      - name: is_problem
        description: Flag indicating if recorded as a problem

      - name: problem_end_date
        description: End date for the problem if resolved