version: 2
models:
  - name: int_dxa_scans_all
    description: 'DXA scan procedures and T-score measurements for osteoporosis diagnosis and bone health monitoring.

      One row per DXA observation using DXA_COD (procedures) and DXA2_COD (T-scores) clusters with clinical T-score interpretation and QOF osteoporosis confirmation flags.'
    tests:
      - cluster_ids_exist:
          arguments:
            cluster_ids: DXA2_COD, DXA_COD
      - dbt_utils.unique_combination_of_columns:
          arguments:
            combination_of_columns:
              - id
              - source_cluster_id
