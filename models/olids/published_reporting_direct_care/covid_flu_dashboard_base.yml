version: 2

models:
  - name: covid_flu_dashboard_base
    description: 'Dashboard-ready COVID and flu vaccination data with demographics.

      Grain: One row per person per campaign per risk group they qualify for

      Contains:
      
      • Complete demographics and practice registration

      • Eligibility status and reasons for each programme

      • Vaccination status (vaccinated, declined, no record)

      • Programme identifier (COVID/FLU) for filtering

      • Campaign details and timing metrics

      Purpose: Single source of truth for COVID and Flu Dashboard consumption with full demographic breakdowns for equity analysis.'
    
    config:
      meta:
        indicator:
          id: "COVID_FLU_DASHBOARD_BASE"
          type: "PROGRAMME"
          category: "MULTI_PROGRAMME"
          clinical_domain: "Programme Management"
          name_short: "COVID and Flu Dashboard Base"
          description_short: "Dashboard-ready COVID and flu vaccination data with demographics"
          description_long: >
            Dashboard-ready COVID and flu vaccination data combining uptake facts
            with complete demographics, practice registration, and geographic data.
            Provides single source for COVID/Flu dashboard with demographic breakdowns
            supporting equity analysis, programme monitoring, and performance assessment
            across vaccination programmes and campaign periods.
          is_qof: false
          source_column: "uptake_category"
          sort_order: "MULTI_104_DASHBOARD_BASE"
          usage_contexts:
            - "COVID_AND_FLU_DASHBOARD"
          code_clusters:
            - cluster_id: "COVADM_COD"
              category: "INCLUSION"
            - cluster_id: "COVRX_COD"
              category: "INCLUSION"
            - cluster_id: "FLUVAX_COD"
              category: "INCLUSION"
            - cluster_id: "FLURX_COD"
              category: "INCLUSION"
          thresholds:
            - population_group: "COVID_NATIONAL_TARGET"
              threshold_type: "COVERAGE_RATE"
              threshold_value: "75"
              threshold_operator: "TARGET"
              threshold_unit: "percentage"
              description: "National COVID vaccination coverage target"
              sort_order: 1
            - population_group: "FLU_NATIONAL_TARGET"
              threshold_type: "COVERAGE_RATE"
              threshold_value: "75"
              threshold_operator: "TARGET"
              threshold_unit: "percentage"
              description: "National flu vaccination coverage target"
              sort_order: 2
    
    columns:
      - name: programme_type
        description: Programme identifier (COVID or FLU)
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['COVID', 'FLU']
        
      - name: campaign_id
        description: Campaign identifier (programme-specific)
        tests:
          - not_null
        
      - name: campaign_year
        description: Campaign year (e.g., 2024/25, 2025/26)
        
      - name: campaign_season
        description: Campaign season (Autumn, Spring, Annual)
        
      - name: person_id
        description: Unique person identifier
        tests:
          - not_null
        
      - name: is_active
        description: Whether person is active in the system
        
      - name: sex
        description: Person's sex
        
      - name: age
        description: Person's current age
        
      - name: age_band_5y
        description: 5-year age band grouping
        
      - name: age_band_10y
        description: 10-year age band grouping
        
      - name: age_band_nhs
        description: NHS standard age band grouping
        
      - name: ethnicity_category
        description: High-level ethnicity categorisation
        
      - name: ethnicity_subcategory
        description: Detailed ethnicity subcategory
        
      - name: main_language
        description: Person's main spoken language
        
      - name: interpreter_needed
        description: Whether interpreter services are needed
        
      - name: imd_quintile_19
        description: Index of Multiple Deprivation quintile (2019)
        
      - name: imd_decile_19
        description: Index of Multiple Deprivation decile (2019)
        
      - name: lsoa_code
        description: Lower Super Output Area code
        
      - name: practice_code
        description: GP practice code
        
      - name: practice_name
        description: GP practice name
        
      - name: pcn_code
        description: Primary Care Network code
        
      - name: pcn_name
        description: Primary Care Network name
        
      - name: borough_registered
        description: Borough where practice is located
        
      - name: is_eligible
        description: Whether person is eligible for vaccination
        
      - name: campaign_category
        description: Category of eligibility
        
      - name: risk_group
        description: Specific risk group classification
        
      - name: eligibility_reason
        description: Reason for eligibility
        
      - name: vaccination_status
        description: Vaccination status
        
      - name: vaccination_date
        description: Date of vaccination (if vaccinated)
        
      - name: vaccinated
        description: Whether person received vaccination
        
      - name: declined
        description: Whether person declined vaccination
        
      - name: eligible_no_record
        description: Whether eligible person has no vaccination record
        
      - name: uptake_category
        description: Categorised uptake status
        
      - name: days_to_vaccination
        description: Days from campaign start to vaccination
        
      - name: laiv_given
        description: Whether LAIV was administered (flu only)
        
      - name: campaign_start_date
        description: Campaign start date