-- Raw layer model for sus_apc.spell
-- Source: "DATA_LAKE"."SUS_UNIFIED_APC"
-- Description: SUS admitted patient care episodes and procedures
-- This is a 1:1 passthrough from source with standardized column names
select
    "spell.patient.registration_derived.responsible_ccg_from_pds" as spell_patient_registration_derived_responsible_ccg_from_pds,
    "spell.patient.residence.postcode Pseudo" as spell_patient_residence_postcode_pseudo,
    "spell.patient.residence.postcode_is_valid" as spell_patient_residence_postcode_is_valid,
    "spell.patient.residence.residence_ccg" as spell_patient_residence_residence_ccg,
    "spell.patient.residence_derived.postcode_from_pds Pseudo" as spell_patient_residence_derived_postcode_from_pds_pseudo,
    "spell.patient.residence_derived.residence_ccg_from_patient_postcode" as spell_patient_residence_derived_residence_ccg_from_patient_postcode,
    "spell.patient.residence_derived.postcode_district" as spell_patient_residence_derived_postcode_district,
    "spell.patient.residence_derived.oa_11" as spell_patient_residence_derived_oa_11,
    "spell.patient.residence_derived.msoa_11" as spell_patient_residence_derived_msoa_11,
    "spell.patient.residence_derived.lsoa_11" as spell_patient_residence_derived_lsoa_11,
    "spell.patient.residence_derived.country" as spell_patient_residence_derived_country,
    "spell.patient.residence_derived.government_office_region" as spell_patient_residence_derived_government_office_region,
    "spell.patient.residence_derived.residence_county" as spell_patient_residence_derived_residence_county,
    "spell.patient.residence_derived.local_authority_district" as spell_patient_residence_derived_local_authority_district,
    "spell.patient.residence_derived.parliamentary_constituency" as spell_patient_residence_derived_parliamentary_constituency,
    "spell.patient.residence_derived.ed_county_code" as spell_patient_residence_derived_ed_county_code,
    "spell.patient.residence_derived.ed_district_code" as spell_patient_residence_derived_ed_district_code,
    "spell.patient.residence_derived.electoral_ward_1998" as spell_patient_residence_derived_electoral_ward_1998,
    "spell.patient.residence_derived.index_of_multiple_deprivation.decile" as spell_patient_residence_derived_index_of_multiple_deprivation_decile,
    "spell.patient.residence_derived.index_of_multiple_deprivation.decile_description" as spell_patient_residence_derived_index_of_multiple_deprivation_decile_description,
    "spell.patient.residence_derived.rural_urban_indicator" as spell_patient_residence_derived_rural_urban_indicator,
    "spell.patient.residence_derived.cancer_registry" as spell_patient_residence_derived_cancer_registry,
    "spell.patient.residence_derived.grid_reference" as spell_patient_residence_derived_grid_reference,
    "spell.patient.mental_health_act_legal_status.classification" as spell_patient_mental_health_act_legal_status_classification,
    "spell.patient.identity.nhs_number.value Pseudo" as spell_patient_identity_nhs_number_value_pseudo,
    "spell.patient.identity.nhs_number.status" as spell_patient_identity_nhs_number_status,
    "spell.patient.identity.nhs_number.is_valid" as spell_patient_identity_nhs_number_is_valid,
    "spell.patient.identity.local_patient_identifier.value" as spell_patient_identity_local_patient_identifier_value,
    "spell.patient.identity.local_patient_identifier.issuer" as spell_patient_identity_local_patient_identifier_issuer,
    "spell.patient.identity.birth_date" as spell_patient_identity_birth_date,
    "spell.patient.identity.birth_month" as spell_patient_identity_birth_month,
    "spell.patient.identity.birth_year" as spell_patient_identity_birth_year,
    "spell.patient.identity.age_range" as spell_patient_identity_age_range,
    "spell.patient.identity.age_at_cds_activity_date" as spell_patient_identity_age_at_cds_activity_date,
    "spell.patient.identity.spell_age" as spell_patient_identity_spell_age,
    "spell.patient.identity.age_on_admission" as spell_patient_identity_age_on_admission,
    "spell.patient.identity.age_at_record_start" as spell_patient_identity_age_at_record_start,
    "spell.patient.identity.fractional_age_at_record_start" as spell_patient_identity_fractional_age_at_record_start,
    "spell.patient.identity.hes_age_at_record_start" as spell_patient_identity_hes_age_at_record_start,
    "spell.patient.identity.age_at_record_end" as spell_patient_identity_age_at_record_end,
    "spell.patient.identity.hes_age_at_record_end" as spell_patient_identity_hes_age_at_record_end,
    "spell.patient.identity.gender" as spell_patient_identity_gender,
    "spell.patient.identity.ethnic_category" as spell_patient_identity_ethnic_category,
    "spell.patient.identity.marital_status" as spell_patient_identity_marital_status,
    "spell.patient.registration.general_practitioner" as spell_patient_registration_general_practitioner,
    "spell.patient.registration.general_practice" as spell_patient_registration_general_practice,
    "spell.patient.registration.responsible_ccg" as spell_patient_registration_responsible_ccg,
    "spell.patient.registration_derived.general_practice_from_pds" as spell_patient_registration_derived_general_practice_from_pds,
    "spell.referral_to_treatment.patient_pathway_identifier.value Pseudo" as spell_referral_to_treatment_patient_pathway_identifier_value_pseudo,
    "spell.referral_to_treatment.patient_pathway_identifier.issuer" as spell_referral_to_treatment_patient_pathway_identifier_issuer,
    "spell.referral_to_treatment.period_status" as spell_referral_to_treatment_period_status,
    "spell.referral_to_treatment.waiting_time_measurement_type" as spell_referral_to_treatment_waiting_time_measurement_type,
    "spell.referral_to_treatment.period_start_date" as spell_referral_to_treatment_period_start_date,
    "spell.discharge.to_hospital_at_home" as spell_discharge_to_hospital_at_home,
    "spell.commissioning.service_agreement.provider_reference_number" as spell_commissioning_service_agreement_provider_reference_number,
    "spell.patient.mother.nhs_number.value Pseudo" as spell_patient_mother_nhs_number_value_pseudo,
    "spell.patient.mother.nhs_number.status" as spell_patient_mother_nhs_number_status,
    "spell.patient.mother.local_patient_identifier.value" as spell_patient_mother_local_patient_identifier_value,
    "spell.patient.mother.local_patient_identifier.issuer" as spell_patient_mother_local_patient_identifier_issuer,
    "spell.patient.mother.birth_date" as spell_patient_mother_birth_date,
    "spell.patient.mother.birth_month" as spell_patient_mother_birth_month,
    "spell.patient.mother.birth_year" as spell_patient_mother_birth_year,
    "spell.patient.mother.age_range" as spell_patient_mother_age_range,
    "spell.patient.mother.postcode Pseudo" as spell_patient_mother_postcode_pseudo,
    "spell.patient.mother.residence_ccg" as spell_patient_mother_residence_ccg,
    "spell.patient.mother.postcode_from_pds Pseudo" as spell_patient_mother_postcode_from_pds_pseudo,
    "spell.patient.mother.residence_ccg_from_pds" as spell_patient_mother_residence_ccg_from_pds,
    "spell.patient.mother.general_practice_from_pds" as spell_patient_mother_general_practice_from_pds,
    "spell.patient.mother.responsible_ccg_from_pds" as spell_patient_mother_responsible_ccg_from_pds,
    "spell.discharge.ready_date" as spell_discharge_ready_date,
    "spell.referral_to_treatment.period_end_date" as spell_referral_to_treatment_period_end_date,
    "spell.referral_to_treatment.period_length" as spell_referral_to_treatment_period_length,
    "spell.patient.overseas_visitor.classification" as spell_patient_overseas_visitor_classification,
    "spell.referral.referrer" as spell_referral_referrer,
    "spell.referral.referring_organisation" as spell_referral_referring_organisation,
    "spell.referral.decided_to_admit_date" as spell_referral_decided_to_admit_date,
    "spell.admission.administrative_category" as spell_admission_administrative_category,
    "spell.admission.intended_management" as spell_admission_intended_management,
    "spell.admission.patient_classification" as spell_admission_patient_classification,
    "spell.admission.method" as spell_admission_method,
    "spell.admission.source" as spell_admission_source,
    "spell.admission.date" as spell_admission_date,
    "spell.admission.time" as spell_admission_time,
    "spell.admission.duration_elective_wait" as spell_admission_duration_elective_wait,
    "spell.admission.admission_type" as spell_admission_admission_type,
    "spell.admission.admission_sub_type" as spell_admission_admission_sub_type,
    "spell.discharge.destination" as spell_discharge_destination,
    "spell.discharge.method" as spell_discharge_method,
    "spell.discharge.date" as spell_discharge_date,
    "spell.discharge.time" as spell_discharge_time,
    "spell.discharge.length_of_hospital_stay" as spell_discharge_length_of_hospital_stay,
    "spell.discharge.pbr_delayed_discharge_days" as spell_discharge_pbr_delayed_discharge_days,
    "spell.care_location.site_code_of_treatment" as spell_care_location_site_code_of_treatment,
    "spell.care_location.organisation_geographies.postcode_district" as spell_care_location_organisation_geographies_postcode_district,
    "spell.care_location.organisation_geographies.government_office_region" as spell_care_location_organisation_geographies_government_office_region,
    "spell.care_location.organisation_geographies.sha_provider" as spell_care_location_organisation_geographies_sha_provider,
    "spell.care_location.organisation_geographies.ccg_from_treatment_site.value" as spell_care_location_organisation_geographies_ccg_from_treatment_site_value,
    "spell.commissioning.tariff_calculation.admission_type" as spell_commissioning_tariff_calculation_admission_type,
    "spell.commissioning.tariff_calculation.patient_type" as spell_commissioning_tariff_calculation_patient_type,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.unadjusted_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_unadjusted_days,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.critical_care_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_critical_care_days,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.rehabilitation_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_rehabilitation_days,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.palliative_care_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_palliative_care_days,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.qualifying_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_qualifying_days,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.trim_point" as spell_commissioning_tariff_calculation_pbr_length_of_stay_trim_point,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.excess_bed_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_excess_bed_days,
    "spell.commissioning.tariff_calculation.pbr_length_of_stay.pbr_delayed_discharge_days" as spell_commissioning_tariff_calculation_pbr_length_of_stay_pbr_delayed_discharge_days,
    "spell.commissioning.tariff_calculation.tariff_applied" as spell_commissioning_tariff_calculation_tariff_applied,
    "spell.commissioning.tariff_calculation.initial_tariff" as spell_commissioning_tariff_calculation_initial_tariff,
    "spell.commissioning.tariff_calculation.per_diem_rate" as spell_commissioning_tariff_calculation_per_diem_rate,
    "spell.commissioning.tariff_calculation.excess_bed_days_tariff" as spell_commissioning_tariff_calculation_excess_bed_days_tariff,
    "spell.commissioning.tariff_calculation.market_forces_factor" as spell_commissioning_tariff_calculation_market_forces_factor,
    "spell.commissioning.tariff_calculation.final_price" as spell_commissioning_tariff_calculation_final_price,
    "spell.commissioning.commissioner_assignment.commissioner" as spell_commissioning_commissioner_assignment_commissioner,
    "spell.commissioning.commissioner_assignment.flowchart_reference" as spell_commissioning_commissioner_assignment_flowchart_reference,
    "spell.referral.direct_access_indicator" as spell_referral_direct_access_indicator,
    "spell.commissioning.service_agreement.line_number" as spell_commissioning_service_agreement_line_number,
    "spell.commissioning.commissioner_assignment.nhse_planning_commissioner" as spell_commissioning_commissioner_assignment_nhse_planning_commissioner,
    "spell.patient.identity.carer_support_indicator" as spell_patient_identity_carer_support_indicator,
    "spell.commissioning.tariff_calculation.aggregate_unbundled_tariff" as spell_commissioning_tariff_calculation_aggregate_unbundled_tariff,
    "spell.referral_to_treatment.ubrn.issuer" as spell_referral_to_treatment_ubrn_issuer,
    "spell.care_location.organisation_geographies.ccg_from_treatment_site.origin" as spell_care_location_organisation_geographies_ccg_from_treatment_site_origin,
    "spell.care_location.organisation_geographies.lsoa_provider_distance.value" as spell_care_location_organisation_geographies_lsoa_provider_distance_value,
    "spell.care_location.organisation_geographies.lsoa_provider_distance.origin" as spell_care_location_organisation_geographies_lsoa_provider_distance_origin,
    "spell.care_location.organisation_geographies.lsoa_site_of_treatment_distance.value" as spell_care_location_organisation_geographies_lsoa_site_of_treatment_distance_value,
    "spell.care_location.organisation_geographies.lsoa_site_of_treatment_distance.origin" as spell_care_location_organisation_geographies_lsoa_site_of_treatment_distance_origin,
    "spell.clinical_coding.grouper_derived.primary_diagnosis" as spell_clinical_coding_grouper_derived_primary_diagnosis,
    "spell.clinical_coding.grouper_derived.secondary_diagnosis" as spell_clinical_coding_grouper_derived_secondary_diagnosis,
    "spell.clinical_coding.grouper_derived.dominant_procedure" as spell_clinical_coding_grouper_derived_dominant_procedure,
    "spell.clinical_coding.procedure.operation_status" as spell_clinical_coding_procedure_operation_status,
    "spell.commissioning.service_agreement.provider" as spell_commissioning_service_agreement_provider,
    "spell.commissioning.service_agreement.provider_derived" as spell_commissioning_service_agreement_provider_derived,
    "spell.commissioning.service_agreement.commissioner" as spell_commissioning_service_agreement_commissioner,
    "spell.commissioning.service_agreement.is_commissioner_recognised" as spell_commissioning_service_agreement_is_commissioner_recognised,
    "spell.commissioning.service_agreement.commissioner_derived" as spell_commissioning_service_agreement_commissioner_derived,
    "spell.commissioning.service_agreement.commissioning_serial_number" as spell_commissioning_service_agreement_commissioning_serial_number,
    "spell.commissioning.service_agreement.commissioner_reference_number" as spell_commissioning_service_agreement_commissioner_reference_number,
    "spell.commissioning.service_agreement.applicable_costing_period" as spell_commissioning_service_agreement_applicable_costing_period,
    "spell.commissioning.grouping.core_hrg" as spell_commissioning_grouping_core_hrg,
    "spell.commissioning.grouping.grouping_method" as spell_commissioning_grouping_grouping_method,
    "spell.commissioning.grouping.programme_budgeting_category" as spell_commissioning_grouping_programme_budgeting_category,
    "spell.commissioning.grouping.code_cleaning_applied" as spell_commissioning_grouping_code_cleaning_applied,
    "spell.commissioning.pss_grouping.tariff_uplift_rate" as spell_commissioning_pss_grouping_tariff_uplift_rate,
    "spell.commissioning.tariff_calculation.excluded_from_pbr" as spell_commissioning_tariff_calculation_excluded_from_pbr,
    "spell.commissioning.tariff_calculation.spell_type" as spell_commissioning_tariff_calculation_spell_type,
    "ROWNUMBER_ID" as rownumber_id,
    "PRIMARYKEY_ID" as primarykey_id,
    "type" as type,
    "action" as action,
    "schema_version" as schema_version,
    "system.report.as_at" as system_report_as_at,
    "system.report.date_range" as system_report_date_range,
    "system.report.clear_data" as system_report_clear_data,
    "system.report.grouper_version" as system_report_grouper_version,
    "system.report.tariff_version" as system_report_tariff_version,
    "system.report.query_identifier" as system_report_query_identifier,
    "system.report.query_date" as system_report_query_date,
    "system.report.query_time" as system_report_query_time,
    "system.interchange.received_date" as system_interchange_received_date,
    "system.interchange.received_time" as system_interchange_received_time,
    "system.transaction.cds_activity_date" as system_transaction_cds_activity_date,
    "system.record.identifier" as system_record_identifier,
    "system.record.version" as system_record_version,
    "system.record.cds_group_indicator" as system_record_cds_group_indicator,
    "spell.hospital_provider_spell_number" as spell_hospital_provider_spell_number,
    "spell.open_spell_indicator" as spell_open_spell_indicator,
    "spell.pbr_included_episodes_in_spell" as spell_pbr_included_episodes_in_spell,
    "spell.pbr_excluded_episodes_in_spell" as spell_pbr_excluded_episodes_in_spell,
    "spell.has_data_quality_error" as spell_has_data_quality_error,
    "spell.commissioning.pss_grouping.national_programme_code" as spell_commissioning_pss_grouping_national_programme_code,
    "spell.commissioning.pss_grouping.prescribed_service_line_code" as spell_commissioning_pss_grouping_prescribed_service_line_code,
    "spell.commissioning.tariff_calculation.specialised_services_tariff_uplift" as spell_commissioning_tariff_calculation_specialised_services_tariff_uplift,
    "spell.referral_to_treatment.ubrn.value Pseudo" as spell_referral_to_treatment_ubrn_value_pseudo,
    "spell.referral.earliest_reasonable_offer_date" as spell_referral_earliest_reasonable_offer_date,
    "spell.commissioning.grouping.best_practice_flag" as spell_commissioning_grouping_best_practice_flag,
    "spell.commissioning.grouping.best_practice_action" as spell_commissioning_grouping_best_practice_action,
    "spell.patient.identity.pds_death_status" as spell_patient_identity_pds_death_status,
    "spell.patient.identity.pds_date_of_death" as spell_patient_identity_pds_date_of_death,
    "spell.ambulance.conveying_trust" as spell_ambulance_conveying_trust,
    "system.record.confidentiality_category" as system_record_confidentiality_category,
    "spell.patient.identity.withheld_identity_reason" as spell_patient_identity_withheld_identity_reason,
    "spell.patient.mother.overseas_visitor_status" as spell_patient_mother_overseas_visitor_status,
    "spell.ambulance.incident_number" as spell_ambulance_incident_number,
    "spell.commissioning.evidence_based_intervention.category" as spell_commissioning_evidence_based_intervention_category,
    "spell.commissioning.evidence_based_intervention.type" as spell_commissioning_evidence_based_intervention_type,
    "spell.patient.mother.withheld_identity_reason" as spell_patient_mother_withheld_identity_reason,
    "dmicImportLogId" as dmic_import_log_id,
    "system.report.activity_date_from" as system_report_activity_date_from,
    "system.report.activity_date_to" as system_report_activity_date_to,
    "system.interchange.latest_episode_received_date" as system_interchange_latest_episode_received_date,
    "system.interchange.latest_episode_received_time" as system_interchange_latest_episode_received_time,
    "spell.patient.identity.ethnic_category_2021" as spell_patient_identity_ethnic_category_2021,
    "spell.referral.latest_clinically_appropriate_date" as spell_referral_latest_clinically_appropriate_date,
    "spell.patient.mother.overseas_visitor_charging_category_at_cds_activity_date" as spell_patient_mother_overseas_visitor_charging_category_at_cds_activity_date,
    "spell.commissioning.tariff_calculation.aggregate_unbundled_guide_tariff" as spell_commissioning_tariff_calculation_aggregate_unbundled_guide_tariff
from {{ source('sus_apc', 'spell') }}
