-- Staging model for epd_primary_care.Meds
-- Source: "DATA_LAKE"."EPD_PRIMARY_CARE"
{% if source.get('description') %}
-- Description: Primary care medications and prescribing data
{% endif %}

select
    "AgeBands" as agebands,
    "BSAPrescriptionID" as bsaprescriptionid,
    "ChargeStatus" as chargestatus,
    "CostCentreLSOA" as costcentrelsoa,
    "CostCentreODSCode" as costcentreodscode,
    "CostCentreSubType" as costcentresubtype,
    "CostCentreType" as costcentretype,
    "DispensedCountryCode" as dispensedcountrycode,
    "DispensedPharmacyLSOA" as dispensedpharmacylsoa,
    "DispensedPharmacyODSCode" as dispensedpharmacyodscode,
    "DispensedPharmacyType" as dispensedpharmacytype,
    "EPSPrescriptionID" as epsprescriptionid,
    "EPSPrescriptionIndicator" as epsprescriptionindicator,
    "ExemptionCode" as exemptioncode,
    "HighVolVaccineIndicator" as highvolvaccineindicator,
    "ItemActualCost" as itemactualcost,
    "ItemCount" as itemcount,
    "ItemID" as itemid,
    "ItemNIC" as itemnic,
    "MaternityExemptionFlag" as maternityexemptionflag,
    "dmicPseudoNHSNumber" as dmicpseudonhsnumber,
    "NotDispensedIndicator" as notdispensedindicator,
    "OutOfHoursIndicator" as outofhoursindicator,
    "PaidACBSIndicator" as paidacbsindicator,
    "PaidBNFCode" as paidbnfcode,
    "PaidBNFName" as paidbnfname,
    "PaidCDIndicator" as paidcdindicator,
    "PaidDisallowedReason" as paiddisallowedreason,
    "PaidDissallowedIndicator" as paiddissallowedindicator,
    "PaidDrugStrength" as paiddrugstrength,
    "PaidFlavourIndicator" as paidflavourindicator,
    "PaidFormulation" as paidformulation,
    "PaidIndicator" as paidindicator,
    "PaidPADMIndicator" as paidpadmindicator,
    "PaidQuantity" as paidquantity,
    "PaidSpecContIndicator" as paidspeccontindicator,
    "PaidSupplierName" as paidsuppliername,
    "PaiddmdCode" as paiddmdcode,
    "PatientAge" as patientage,
    "PatientCCG" as patientccg,
    "PatientGPCCG" as patientgpccg,
    "PatientGPLA" as patientgpla,
    "PatientGPLSOA" as patientgplsoa,
    "PatientGPODS" as patientgpods,
    "PatientGender" as patientgender,
    "PatientLA" as patientla,
    "PatientLSOA" as patientlsoa,
    "PrescribedBNFCode" as prescribedbnfcode,
    "PrescribedBNFName" as prescribedbnfname,
    "PrescribedCountryCode" as prescribedcountrycode,
    "PrescribedFormulation" as prescribedformulation,
    "PrescribedMedicineStrength" as prescribedmedicinestrength,
    "PrescribedQuantity" as prescribedquantity,
    "PrescribedSupplierName" as prescribedsuppliername,
    "PrescribeddmdCode" as prescribeddmdcode,
    "PrescriberID" as prescriberid,
    "PrescriberType" as prescribertype,
    "PrivatePrescriptionIndicator" as privateprescriptionindicator,
    "ProcessedPeriod" as processedperiod,
    "ProcessingPeriodDate" as processingperioddate,
    "dmicImportLogId" as dmicimportlogid,
    "dmicCostCentreODSCCGCode" as dmiccostcentreodsccgcode,
    "dmicCostCentreLSOACCGCode" as dmiccostcentrelsoaccgcode,
    "dmicDispensedPharmacyLSOACCGCode" as dmicdispensedpharmacylsoaccgcode,
    "dmicSystemId" as dmicsystemid,
    "dmicDateAdded" as dmicdateadded,
    "dmicRecordHash" as dmicrecordhash,
    "dmicProcessedPeriod" as dmicprocessedperiod,
    "UniqSubmissionId" as uniqsubmissionid
from {{ source('epd_primary_care', 'Meds') }}
