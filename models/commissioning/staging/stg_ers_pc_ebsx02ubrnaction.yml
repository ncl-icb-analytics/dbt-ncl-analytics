version: 2
models:
  - name: stg_ers_pc_ebsx02ubrnaction
    description: "e-Referral Service (ERS) UBRN actions and pathway data"
    tests:
      - dbt_utils.at_least_one
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - ubrn_id
            - action_dt_tm
    columns:
      - name: ubrn_id
        description: "Unique Booking Reference Number identifier"
        tests:
          - not_null

      - name: e_referral_pathway_start
        description: "Date e-referral pathway started"

      - name: patient_id
        description: "Patient identifier"

      - name: patients_reg_gp_practice_id
        description: "Patient's registered GP practice identifier"

      - name: sk_patient_id
        description: "Pseudonymised NHS number (surrogate key for patient)"

      - name: patient_age
        description: "Patient age at time of action"

      - name: original_priority_cd
        description: "Original priority code"

      - name: original_priority_desc
        description: "Original priority description"

      - name: specialty_cd
        description: "Specialty code"

      - name: specialty_desc
        description: "Specialty description"

      - name: clinic_type_cd
        description: "Clinic type code"

      - name: clinic_type_desc
        description: "Clinic type description"

      - name: priority_cd
        description: "Priority code"

      - name: priority_desc
        description: "Priority description"

      - name: referrer_org_name
        description: "Referring organisation name"

      - name: referring_org_id
        description: "Referring organisation identifier"

      - name: appt_type_cd
        description: "Appointment type code"

      - name: appt_type_desc
        description: "Appointment type description"

      - name: provider_org_id
        description: "Provider organisation identifier"

      - name: provider_org_name
        description: "Provider organisation name"

      - name: provider_org_type_desc
        description: "Provider organisation type description"

      - name: service_specialty_cd
        description: "Service specialty code"

      - name: service_specialty_desc
        description: "Service specialty description"

      - name: action_dt_tm
        description: "Date/time of action"
        tests:
          - not_null

      - name: action_desc
        description: "Action description"
