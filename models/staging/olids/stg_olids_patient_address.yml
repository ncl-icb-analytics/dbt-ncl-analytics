version: 2
models:
- name: stg_olids_patient_address
  description: Patient address history linking patients to postcodes. Deduplicated
    by id - note that deleted records are not filtered as lds_is_deleted is not used
    in this table.
  columns:
  - name: id
    description: Primary key - unique identifier for this patient address record
    tests:
    - unique
    - not_null
  - name: patient_id
    description: Foreign key to patient.id
  - name: address_type_concept_id
    description: Foreign key to concept.id - type of address (home, temporary, work,
      etc.)
  - name: postcode_hash
    description: Foreign key to postcode_hash.postcode_hash - hashed postcode
  - name: start_date
    description: Start date of the patient living at this address
  - name: end_date
    description: End date of the patient living at this address
  - name: person_id
    description: Foreign key to person.id - person-level identifier
  - name: lds_id
    description: LDS system identifier
  - name: record_owner_organisation_code
    description: Organisation code of the record owner
  - name: lds_datetime_data_acquired
    description: Datetime when data was acquired by LDS
  - name: lds_initial_data_received_date
    description: Date when data was initially received by LDS
  - name: lds_start_date_time
    description: LDS datetime stamp from which the record version was correct - used
      for deduplication to get the latest record
  - name: lds_record_id
    description: LDS assigned unique identifier for the source record version
  tests:
  - dbt_expectations.expect_table_row_count_to_be_between:
      min_value: 1
