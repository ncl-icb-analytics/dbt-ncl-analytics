version: 2
models:
- name: stg_olids_patient_person
  description: Junction table linking patient records to person records for identity
    management. Deduplicated by id using lds_start_date_time.
  columns:
  - name: id
    description: Primary key - unique identifier for this patient-person link
    tests:
    - unique
    - not_null
  - name: lds_record_id
    description: LDS assigned unique identifier for the source record version
  - name: lds_id
    description: LDS system identifier
  - name: lds_business_key
    description: LDS business key identifier
  - name: lds_cdm_event_id
    description: LDS CDM event identifier
  - name: lds_datetime_data_acquired
    description: Datetime when data was acquired by LDS
  - name: lds_dataset_id
    description: LDS dataset identifier
  - name: patient_id
    description: Foreign key to patient.id
  - name: person_id
    description: Foreign key to person.id
  - name: lds_start_date_time
    description: LDS datetime stamp from which the record version was correct - used
      for deduplication to get the latest record
  - name: lds_is_deleted
    description: Deletion flag from LDS
  - name: lds_lakehouse_date_processed
    description: Date when record was processed by lakehouse
  - name: lds_lakehouse_datetime_updated
    description: Datetime when record was last updated in lakehouse
  - name: lds_record_id_person
    description: LDS record identifier for person
  tests:
  - dbt_expectations.expect_table_row_count_to_be_between:
      min_value: 1
