version: 2
models:
- name: stg_csds_cyp607primdiag
  description: | 
    CSDS (deduplicated) Primary Diagnosis. 
    To carry the details of the primary diagnosis for a patient made by the service that the patient 
    was referred to. One occurrence of this Group is permitted for the primary diagnosis
  tests:
  - dbt_expectations.expect_table_row_count_to_be_between:
      min_value: 1
  columns:
  - name: unique_service_request_identifier
    description: referral identifier
    tests:
    - not_null
  - name: person_id
    description: A nationally unique pseudonymised ID for the patient generated by the Master Person Service (MPS).
  - name: diagnosis_scheme_in_use_community_care
    description: the type of coded clinical entry used for the patient diagnosis (eg. ICD-10, snomed, read code).
  - name: primary_diagnosis_coded_clinical_entry
    description: The coded clinical entry used to identify the primary diagnosis
    tests:
    - not_null
  - name: diagnosis_date
    description: The date when the patient diagnosis was observed by a person.
  - name: record_number
    description: This is a unique ID, which identifies each flowed patient record. The rows in the CYP001MPI and associated episode and event tables within a submission are linked via the Record Number.
  - name: organisation_identifier_code_of_provider
    description: Organisation Identifier of provider submitting the data.
  - name: cyp607_unique_id
    description: A unique ID per table. This continues across reporting periods and across providers. This uniquely identifies a row of data within a table.
    tests:
    - not_null
    - unique






  