version: 2
models:
- name: stg_pds_pds_reason_for_removal
  description: PDS reason for removal from GP practice registration
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - row_id
      - sk_patient_id
  columns:
  - name: row_id
    description: Row identifier
    tests:
    - not_null
  - name: sk_patient_id
    description: Surrogate key patient identifier (pseudonymised NHS number)
    tests:
    - not_null
  - name: reason_for_removal
    description: Reason code for removal from GP practice (e.g., death, moved away, transferred)
  - name: reason_for_removal_business_effective_from_date
    description: Date from which removal reason is effective
  - name: reason_for_removal_business_effective_to_date
    description: Date to which removal reason is effective (NULL if current)
