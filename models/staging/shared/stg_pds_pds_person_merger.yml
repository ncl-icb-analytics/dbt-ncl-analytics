models:
  - name: stg_pds_pds_person_merger
    description: NHS number merger tracking from PDS. Maps old NHS numbers to 
      new ones when patients have had their NHS number changed.
    config:
      meta:
        owner:
          name: Eddie Davison
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - row_id
            - sk_patient_id
    columns:
      - name: row_id
        description: Row identifier
        tests:
          - not_null
      - name: sk_patient_id
        description: Surrogate key patient identifier (pseudonymised NHS number 
          - old/superseded number)
        tests:
          - not_null
      - name: sk_patient_id_superseded
        description: New NHS number that supersedes the old one (canonical 
          identifier)
        tests:
          - not_null
      - name: person_merger_business_effective_from_date
        description: Date from which the merger is effective
      - name: person_merger_business_effective_to_date
        description: Date to which the merger is effective (NULL if current)
