version: 2

models:
  - name: population_health_needs_demographics_ltcs
    description: 'Aggregate patient counts by age, ethnicity, PCN, neighbourhood, IMD quintile, LTCs for population health needs dashboard.'
    tests:
      - dbt_utils.expression_is_true:
          expression: "patient_count >= 1"
    config:
      materialized: view
    columns:
      - name: is_active
        description: Indicates if the patient is currently active.
      - name: is_deceased
        description: Indicates if the patient is deceased.
      - name: gender
        description: Patient's gender.
      - name: age_band_5y
        description: Age band in 5-year intervals.
      - name: age_band_10y
        description: Age band in 10-year intervals.
      - name: age_band_nhs
        description: NHS-defined age band.
      - name: age_band_ons
        description: ONS-defined age band.
      - name: age_life_stage
        description: Life stage classification based on age.
      - name: ethnicity_category
        description: Broad ethnicity category.
      - name: ethnicity_subcategory
        description: Subcategory of ethnicity.
      - name: ethnicity_granular
        description: Granular ethnicity classification.
      - name: main_language
        description: Patient's main spoken language.
      - name: pcn_name
        description: Name of the Primary Care Network.
      - name: neighbourhood_registered
        description: Neighbourhood of the patient's GP practice.
      - name: borough_registered
        description: Borough of the patient's GP practice.
      - name: practice_imd_quintile_19
        description: Index of Multiple Deprivation quintile (2019) of the patient's GP practice.
      - name: patient_imd_quintile_19
        description: Index of Multiple Deprivation quintile (2019) of the patient.
      - name: has_atrial_fibrillation
      - name: has_coronary_heart_disease
      - name: has_heart_failure
      - name: has_hypertension
      - name: has_peripheral_arterial_disease
      - name: has_stroke_tia
      - name: has_asthma
      - name: has_copd
      - name: has_cyp_asthma
      - name: has_diabetes
      - name: has_gestational_diabetes
      - name: has_non_diabetic_hyperglycaemia
      - name: has_obesity
      - name: has_nafld
      - name: has_dementia
      - name: has_depression
      - name: has_severe_mental_illness
      - name: has_cancer
      - name: has_epilepsy
      - name: has_familial_hypercholesterolaemia
      - name: has_frailty
      - name: has_learning_disability
      - name: has_osteoporosis
      - name: has_palliative_care
      - name: has_rheumatoid_arthritis
      - name: patient_count
        description: Total number of patients in the group.
