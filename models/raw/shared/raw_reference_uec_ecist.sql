-- Raw layer model for reference_analyst_managed.UEC__ECIST
-- Source: "DATA_LAKE__NCL"."ANALYST_MANAGED"
-- Description: Analyst-managed reference datasets and business rules
-- This is a 1:1 passthrough from source with standardized column names
select
    "PERIOD" as period,
    "TRUST_NAME" as trust_name,
    "ORG_CODE" as org_code,
    "SITE_NAME" as site_name,
    "SITE_CODE" as site_code,
    "STP_NAME" as stp_name,
    "REGION_NAME" as region_name,
    "ACC_BEDS_OCCUPIED" as acc_beds_occupied,
    "ACC_BEDS_OPEN" as acc_beds_open,
    "AE_ATTENDANCES" as ae_attendances,
    "AE_BREACHES" as ae_breaches,
    "AE_PERFORMANCE_BOOKED" as ae_performance_booked,
    "AE_PATIENTS_STREAMED" as ae_patients_streamed,
    "AE_PATIENTS_STREAMED_BREACHES" as ae_patients_streamed_breaches,
    "AMB_HANDOVER_30_TO_60" as amb_handover_30_to_60,
    "AMB_HANDOVER_OVER_60" as amb_handover_over_60,
    "AMBULANCE_HANDOVER_4_TO_12_HOURS" as ambulance_handover_4_to_12_hours,
    "AMBULANCE_HANDOVEROVER_12_HOURS" as ambulance_handoverover_12_hours,
    "ARRIVING_BY_AMBULANCE" as arriving_by_ambulance,
    "ATTENDANCES_MAJOR_TYPE_1" as attendances_major_type_1,
    "ATTENDANCES_MINOR_TYPE_1" as attendances_minor_type_1,
    "ATTENDANCES_PAEDS_TYPE_1" as attendances_paeds_type_1,
    "ATTENDANCES_RESUS_TYPE_1" as attendances_resus_type_1,
    "ATTENDANCES_TYPE_1" as attendances_type_1,
    "ATTENDANCES_TYPE_2" as attendances_type_2,
    "ATTENDANCES_TYPE_3" as attendances_type_3,
    "BEDS_OCCUPIED_BY_LONG_STAY_PATIENTS_14_PLUS_DAYS" as beds_occupied_by_long_stay_patients_14_plus_days,
    "BOOKED_BREACHES_TYPE_1" as booked_breaches_type_1,
    "BOOKED_BREACHES_TYPE_2" as booked_breaches_type_2,
    "BOOKED_TYPE_1" as booked_type_1,
    "BOOKED_TYPE_2" as booked_type_2,
    "BREACHES_MAJOR_TYPE_1" as breaches_major_type_1,
    "BREACHES_MINOR_TYPE_1" as breaches_minor_type_1,
    "BREACHES_PAEDS_TYPE_1" as breaches_paeds_type_1,
    "BREACHES_RESUS_TYPE_1" as breaches_resus_type_1,
    "BREACHES_TYPE_1" as breaches_type_1,
    "BREACHES_TYPE_2" as breaches_type_2,
    "BREACHES_TYPE_3" as breaches_type_3,
    "EMERGENCY_ADMISSIONS" as emergency_admissions,
    "EMERGENCY_ADMISSIONS_AE" as emergency_admissions_ae,
    "EXTENDED_PATIENTS_OCCUPIED" as extended_patients_occupied,
    "GA_CORE_BEDS_OPEN" as ga_core_beds_open,
    "GA_ESCALATION_BEDS_OPEN" as ga_escalation_beds_open,
    "GA_TOTAL_BEDS_OCCUPIED" as ga_total_beds_occupied,
    "GA_TOTAL_BEDS_OPEN" as ga_total_beds_open,
    "NUMBER_OF_ADMISSIONS" as number_of_admissions,
    "NUMBER_OF_ADVANCE_BOOKINGS_UTC" as number_of_advance_bookings_utc,
    "NUMBER_OF_DISCHARGES" as number_of_discharges,
    "NUMBER_OF_PATIENTS_SEEN_WITHIN_4_HOURS" as number_of_patients_seen_within_4_hours,
    "OVER_12_HOUR_FROM_ARRIVAL_DUMMY" as over_12_hour_from_arrival_dummy,
    "OVER_12_HOURS_FROM_ARRIVAL" as over_12_hours_from_arrival,
    "SEEN_WITHIN_60_TYPE_1" as seen_within_60_type_1,
    "UNAVAILABLE_BED_STRANDED_PATIENTS" as unavailable_bed_stranded_patients,
    "CRS_ATTENDANCES" as crs_attendances,
    "CRS_TYPE_1" as crs_type_1,
    "NO_CTR" as no_ctr,
    "DISCHARGED_BY_5" as discharged_by_5,
    "DISCHARGED_AFTER_5" as discharged_after_5,
    "NO_CTR_MINUS_DISCHARGES" as no_ctr_minus_discharges,
    "OCCUPANCY_AT_MIDDAY" as occupancy_at_midday,
    "OCCUPANCY_AT_MIDNIGHT" as occupancy_at_midnight,
    "4HR_PERFORMANCE" as performance_4_hr,
    "4HR_NATIONAL_RANK" as rank_4_hr_national,
    "4HR_REGIONAL_RANK" as rank_4_hr_regional,
    "TOTAL_HOURS_LOST_DUE_TO_HANDOVER_DELAYS" as total_hours_lost_due_to_handover_delays,
    "PATIENTS_AWAITING_ADMISSION_AT_8AM" as patients_awaiting_admission_at_8_am,
    "4HR_TYPE_1_NATIONAL_RANK" as rank_4_hr_type_1_national,
    "4HR_TYPE_3_NATIONAL_RANK" as rank_4_hr_type_3_national,
    "4HR_TYPE_3_REGIONAL_RANK" as rank_4_hr_type_3_regional,
    "PAED_4_HOUR_BREACHES" as paed_4_hour_breaches,
    "PAED_12_HOUR_BREACHES" as paed_12_hour_breaches,
    "PAED_ATTENDANCES" as paed_attendances,
    "COVID_ADMISSIONS" as covid_admissions,
    "COVID_OCCUPANCY" as covid_occupancy,
    "TOTAL_HANDOVER_MINUTES" as total_handover_minutes,
    "TOTAL_DATE_DIFFERENCE" as total_date_difference,
    "DISCHARGE_COUNT" as discharge_count,
    "PAED_CORE_GA_BEDS_OPEN" as paed_core_ga_beds_open,
    "PAED_ESCALATION_GA_BEDS_OPEN" as paed_escalation_ga_beds_open,
    "PAED_TOTAL_GA_BEDS_OCCUPIED" as paed_total_ga_beds_occupied,
    "PAED_TOTAL_GA_BEDS_OPEN" as paed_total_ga_beds_open,
    "PICU_BEDS_OCCUPIED" as picu_beds_occupied,
    "PICU_BEDS_OPEN" as picu_beds_open,
    "TTIA_AVERAGE_TIME" as ttia_average_time,
    "PERCENTAGE_TTIA_15_MINS," as percentage_ttia_15_mins,
from {{ source('reference_analyst_managed', 'UEC__ECIST') }}
