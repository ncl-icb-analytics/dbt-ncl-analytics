{{
    config(
        description="Raw layer (Analyst-managed reference datasets and business rules). 1:1 passthrough with cleaned column names. \nSource: DATA_LAKE__NCL.ANALYST_MANAGED.UEC__ECIST \ndbt: source(''reference_analyst_managed'', ''UEC__ECIST'') \nColumns:\n  PERIOD -> period\n  TRUST_NAME -> trust_name\n  ORG_CODE -> org_code\n  SITE_NAME -> site_name\n  SITE_CODE -> site_code\n  STP_NAME -> stp_name\n  REGION_NAME -> region_name\n  ACC_BEDS_OCCUPIED -> acc_beds_occupied\n  ACC_BEDS_OPEN -> acc_beds_open\n  AE_ATTENDANCES -> ae_attendances\n  AE_BREACHES -> ae_breaches\n  AE_PERFORMANCE_BOOKED -> ae_performance_booked\n  AE_PATIENTS_STREAMED -> ae_patients_streamed\n  AE_PATIENTS_STREAMED_BREACHES -> ae_patients_streamed_breaches\n  AMB_HANDOVER_30_TO_60 -> amb_handover_30_to_60\n  AMB_HANDOVER_OVER_60 -> amb_handover_over_60\n  AMBULANCE_HANDOVER_4_TO_12_HOURS -> ambulance_handover_4_to_12_hours\n  AMBULANCE_HANDOVEROVER_12_HOURS -> ambulance_handoverover_12_hours\n  ARRIVING_BY_AMBULANCE -> arriving_by_ambulance\n  ATTENDANCES_MAJOR_TYPE_1 -> attendances_major_type_1\n  ATTENDANCES_MINOR_TYPE_1 -> attendances_minor_type_1\n  ATTENDANCES_PAEDS_TYPE_1 -> attendances_paeds_type_1\n  ATTENDANCES_RESUS_TYPE_1 -> attendances_resus_type_1\n  ATTENDANCES_TYPE_1 -> attendances_type_1\n  ATTENDANCES_TYPE_2 -> attendances_type_2\n  ATTENDANCES_TYPE_3 -> attendances_type_3\n  BEDS_OCCUPIED_BY_LONG_STAY_PATIENTS_14_PLUS_DAYS -> beds_occupied_by_long_stay_patients_14_plus_days\n  BOOKED_BREACHES_TYPE_1 -> booked_breaches_type_1\n  BOOKED_BREACHES_TYPE_2 -> booked_breaches_type_2\n  BOOKED_TYPE_1 -> booked_type_1\n  BOOKED_TYPE_2 -> booked_type_2\n  BREACHES_MAJOR_TYPE_1 -> breaches_major_type_1\n  BREACHES_MINOR_TYPE_1 -> breaches_minor_type_1\n  BREACHES_PAEDS_TYPE_1 -> breaches_paeds_type_1\n  BREACHES_RESUS_TYPE_1 -> breaches_resus_type_1\n  BREACHES_TYPE_1 -> breaches_type_1\n  BREACHES_TYPE_2 -> breaches_type_2\n  BREACHES_TYPE_3 -> breaches_type_3\n  EMERGENCY_ADMISSIONS -> emergency_admissions\n  EMERGENCY_ADMISSIONS_AE -> emergency_admissions_ae\n  EXTENDED_PATIENTS_OCCUPIED -> extended_patients_occupied\n  GA_CORE_BEDS_OPEN -> ga_core_beds_open\n  GA_ESCALATION_BEDS_OPEN -> ga_escalation_beds_open\n  GA_TOTAL_BEDS_OCCUPIED -> ga_total_beds_occupied\n  GA_TOTAL_BEDS_OPEN -> ga_total_beds_open\n  NUMBER_OF_ADMISSIONS -> number_of_admissions\n  NUMBER_OF_ADVANCE_BOOKINGS_UTC -> number_of_advance_bookings_utc\n  NUMBER_OF_DISCHARGES -> number_of_discharges\n  NUMBER_OF_PATIENTS_SEEN_WITHIN_4_HOURS -> number_of_patients_seen_within_4_hours\n  OVER_12_HOUR_FROM_ARRIVAL_DUMMY -> over_12_hour_from_arrival_dummy\n  OVER_12_HOURS_FROM_ARRIVAL -> over_12_hours_from_arrival\n  SEEN_WITHIN_60_TYPE_1 -> seen_within_60_type_1\n  UNAVAILABLE_BED_STRANDED_PATIENTS -> unavailable_bed_stranded_patients\n  CRS_ATTENDANCES -> crs_attendances\n  CRS_TYPE_1 -> crs_type_1\n  NO_CTR -> no_ctr\n  DISCHARGED_BY_5 -> discharged_by_5\n  DISCHARGED_AFTER_5 -> discharged_after_5\n  NO_CTR_MINUS_DISCHARGES -> no_ctr_minus_discharges\n  OCCUPANCY_AT_MIDDAY -> occupancy_at_midday\n  OCCUPANCY_AT_MIDNIGHT -> occupancy_at_midnight\n  4HR_PERFORMANCE -> performance_4_hr\n  4HR_NATIONAL_RANK -> rank_4_hr_national\n  4HR_REGIONAL_RANK -> rank_4_hr_regional\n  TOTAL_HOURS_LOST_DUE_TO_HANDOVER_DELAYS -> total_hours_lost_due_to_handover_delays\n  PATIENTS_AWAITING_ADMISSION_AT_8AM -> patients_awaiting_admission_at_8_am\n  4HR_TYPE_1_NATIONAL_RANK -> rank_4_hr_type_1_national\n  4HR_TYPE_3_NATIONAL_RANK -> rank_4_hr_type_3_national\n  4HR_TYPE_3_REGIONAL_RANK -> rank_4_hr_type_3_regional\n  PAED_4_HOUR_BREACHES -> paed_4_hour_breaches\n  PAED_12_HOUR_BREACHES -> paed_12_hour_breaches\n  PAED_ATTENDANCES -> paed_attendances\n  COVID_ADMISSIONS -> covid_admissions\n  COVID_OCCUPANCY -> covid_occupancy\n  TOTAL_HANDOVER_MINUTES -> total_handover_minutes\n  TOTAL_DATE_DIFFERENCE -> total_date_difference\n  DISCHARGE_COUNT -> discharge_count\n  PAED_CORE_GA_BEDS_OPEN -> paed_core_ga_beds_open\n  PAED_ESCALATION_GA_BEDS_OPEN -> paed_escalation_ga_beds_open\n  PAED_TOTAL_GA_BEDS_OCCUPIED -> paed_total_ga_beds_occupied\n  PAED_TOTAL_GA_BEDS_OPEN -> paed_total_ga_beds_open\n  PICU_BEDS_OCCUPIED -> picu_beds_occupied\n  PICU_BEDS_OPEN -> picu_beds_open\n  TTIA_AVERAGE_TIME -> ttia_average_time\n  PERCENTAGE_TTIA_15_MINS, -> percentage_ttia_15_mins,"
    )
}}
select
    "PERIOD" as period,
    "TRUST_NAME" as trust_name,
    "ORG_CODE" as org_code,
    "SITE_NAME" as site_name,
    "SITE_CODE" as site_code,
    "STP_NAME" as stp_name,
    "REGION_NAME" as region_name,
    "ACC_BEDS_OCCUPIED" as acc_beds_occupied,
    "ACC_BEDS_OPEN" as acc_beds_open,
    "AE_ATTENDANCES" as ae_attendances,
    "AE_BREACHES" as ae_breaches,
    "AE_PERFORMANCE_BOOKED" as ae_performance_booked,
    "AE_PATIENTS_STREAMED" as ae_patients_streamed,
    "AE_PATIENTS_STREAMED_BREACHES" as ae_patients_streamed_breaches,
    "AMB_HANDOVER_30_TO_60" as amb_handover_30_to_60,
    "AMB_HANDOVER_OVER_60" as amb_handover_over_60,
    "AMBULANCE_HANDOVER_4_TO_12_HOURS" as ambulance_handover_4_to_12_hours,
    "AMBULANCE_HANDOVEROVER_12_HOURS" as ambulance_handoverover_12_hours,
    "ARRIVING_BY_AMBULANCE" as arriving_by_ambulance,
    "ATTENDANCES_MAJOR_TYPE_1" as attendances_major_type_1,
    "ATTENDANCES_MINOR_TYPE_1" as attendances_minor_type_1,
    "ATTENDANCES_PAEDS_TYPE_1" as attendances_paeds_type_1,
    "ATTENDANCES_RESUS_TYPE_1" as attendances_resus_type_1,
    "ATTENDANCES_TYPE_1" as attendances_type_1,
    "ATTENDANCES_TYPE_2" as attendances_type_2,
    "ATTENDANCES_TYPE_3" as attendances_type_3,
    "BEDS_OCCUPIED_BY_LONG_STAY_PATIENTS_14_PLUS_DAYS" as beds_occupied_by_long_stay_patients_14_plus_days,
    "BOOKED_BREACHES_TYPE_1" as booked_breaches_type_1,
    "BOOKED_BREACHES_TYPE_2" as booked_breaches_type_2,
    "BOOKED_TYPE_1" as booked_type_1,
    "BOOKED_TYPE_2" as booked_type_2,
    "BREACHES_MAJOR_TYPE_1" as breaches_major_type_1,
    "BREACHES_MINOR_TYPE_1" as breaches_minor_type_1,
    "BREACHES_PAEDS_TYPE_1" as breaches_paeds_type_1,
    "BREACHES_RESUS_TYPE_1" as breaches_resus_type_1,
    "BREACHES_TYPE_1" as breaches_type_1,
    "BREACHES_TYPE_2" as breaches_type_2,
    "BREACHES_TYPE_3" as breaches_type_3,
    "EMERGENCY_ADMISSIONS" as emergency_admissions,
    "EMERGENCY_ADMISSIONS_AE" as emergency_admissions_ae,
    "EXTENDED_PATIENTS_OCCUPIED" as extended_patients_occupied,
    "GA_CORE_BEDS_OPEN" as ga_core_beds_open,
    "GA_ESCALATION_BEDS_OPEN" as ga_escalation_beds_open,
    "GA_TOTAL_BEDS_OCCUPIED" as ga_total_beds_occupied,
    "GA_TOTAL_BEDS_OPEN" as ga_total_beds_open,
    "NUMBER_OF_ADMISSIONS" as number_of_admissions,
    "NUMBER_OF_ADVANCE_BOOKINGS_UTC" as number_of_advance_bookings_utc,
    "NUMBER_OF_DISCHARGES" as number_of_discharges,
    "NUMBER_OF_PATIENTS_SEEN_WITHIN_4_HOURS" as number_of_patients_seen_within_4_hours,
    "OVER_12_HOUR_FROM_ARRIVAL_DUMMY" as over_12_hour_from_arrival_dummy,
    "OVER_12_HOURS_FROM_ARRIVAL" as over_12_hours_from_arrival,
    "SEEN_WITHIN_60_TYPE_1" as seen_within_60_type_1,
    "UNAVAILABLE_BED_STRANDED_PATIENTS" as unavailable_bed_stranded_patients,
    "CRS_ATTENDANCES" as crs_attendances,
    "CRS_TYPE_1" as crs_type_1,
    "NO_CTR" as no_ctr,
    "DISCHARGED_BY_5" as discharged_by_5,
    "DISCHARGED_AFTER_5" as discharged_after_5,
    "NO_CTR_MINUS_DISCHARGES" as no_ctr_minus_discharges,
    "OCCUPANCY_AT_MIDDAY" as occupancy_at_midday,
    "OCCUPANCY_AT_MIDNIGHT" as occupancy_at_midnight,
    "4HR_PERFORMANCE" as performance_4_hr,
    "4HR_NATIONAL_RANK" as rank_4_hr_national,
    "4HR_REGIONAL_RANK" as rank_4_hr_regional,
    "TOTAL_HOURS_LOST_DUE_TO_HANDOVER_DELAYS" as total_hours_lost_due_to_handover_delays,
    "PATIENTS_AWAITING_ADMISSION_AT_8AM" as patients_awaiting_admission_at_8_am,
    "4HR_TYPE_1_NATIONAL_RANK" as rank_4_hr_type_1_national,
    "4HR_TYPE_3_NATIONAL_RANK" as rank_4_hr_type_3_national,
    "4HR_TYPE_3_REGIONAL_RANK" as rank_4_hr_type_3_regional,
    "PAED_4_HOUR_BREACHES" as paed_4_hour_breaches,
    "PAED_12_HOUR_BREACHES" as paed_12_hour_breaches,
    "PAED_ATTENDANCES" as paed_attendances,
    "COVID_ADMISSIONS" as covid_admissions,
    "COVID_OCCUPANCY" as covid_occupancy,
    "TOTAL_HANDOVER_MINUTES" as total_handover_minutes,
    "TOTAL_DATE_DIFFERENCE" as total_date_difference,
    "DISCHARGE_COUNT" as discharge_count,
    "PAED_CORE_GA_BEDS_OPEN" as paed_core_ga_beds_open,
    "PAED_ESCALATION_GA_BEDS_OPEN" as paed_escalation_ga_beds_open,
    "PAED_TOTAL_GA_BEDS_OCCUPIED" as paed_total_ga_beds_occupied,
    "PAED_TOTAL_GA_BEDS_OPEN" as paed_total_ga_beds_open,
    "PICU_BEDS_OCCUPIED" as picu_beds_occupied,
    "PICU_BEDS_OPEN" as picu_beds_open,
    "TTIA_AVERAGE_TIME" as ttia_average_time,
    "PERCENTAGE_TTIA_15_MINS," as percentage_ttia_15_mins,
from {{ source('reference_analyst_managed', 'UEC__ECIST') }}
