-- Raw layer model for reference_analyst_managed.VALPROATE
-- Source: "DATA_LAKE__NCL"."ANALYST_MANAGED"
-- Description: Analyst-managed reference datasets and business rules
-- This is a 1:1 passthrough from source with standardized column names
select
    "PERSON_ID" as person_id,
    "SK_PATIENT_ID" as sk_patient_id,
    "IS_ACTIVE" as is_active,
    "IS_DECEASED" as is_deceased,
    "GENDER" as gender,
    "AGE" as age,
    "AGE_BAND_5Y" as age_band_5_y,
    "AGE_BAND_5Y_ORDER" as age_band_5_y_order,
    "AGE_BAND_10Y" as age_band_10_y,
    "AGE_BAND_10Y_ORDER" as age_band_10_y_order,
    "ETHNICITY_CATEGORY" as ethnicity_category,
    "ETHNICITY_SUBCATEGORY" as ethnicity_subcategory,
    "ETHNICITY_GRANULAR" as ethnicity_granular,
    "MAIN_LANGUAGE" as main_language,
    "INTERPRETER_NEEDED" as interpreter_needed,
    "PRACTICE_CODE" as practice_code,
    "PRACTICE_NAME" as practice_name,
    "PCN_CODE" as pcn_code,
    "PCN_NAME" as pcn_name,
    "PCN_NAME_WITH_BOROUGH" as pcn_name_with_borough,
    "NEIGHBOURHOOD_REGISTERED" as neighbourhood_registered,
    "BOROUGH_REGISTERED" as borough_registered,
    "PATIENT_LSOA" as patient_lsoa,
    "PRACTICE_LSOA" as practice_lsoa,
    "WARD_CODE" as ward_code,
    "WARD_NAME" as ward_name,
    "PATIENT_IMD_DECILE_19" as patient_imd_decile_19,
    "PATIENT_IMD_QUINTILE_19" as patient_imd_quintile_19,
    "AGE_GROUP" as age_group,
    "DATE_OF_LAST_VALPROATE_ISSUE" as date_of_last_valproate_issue,
    "CURRENT_PPP_STATUS_DESCRIPTION" as current_ppp_status_description,
    "PREGNANCY_PREVENTION_PROGRAMME_ENROLMENT_STATUS" as pregnancy_prevention_programme_enrolment_status,
    "PREGNANCY_PREVENTION_PROGRAMME_DESC" as pregnancy_prevention_programme_desc,
    "OLD_ANNUAL_RISK_ACKNOWLEDGEMENT_FORM" as old_annual_risk_acknowledgement_form,
    "NEW_ANNUAL_RISK_ACKNOWLEDGEMENT_FORM" as new_annual_risk_acknowledgement_form,
    "ARAF_COMPLETED_IN_12_MONTHS" as araf_completed_in_12_months,
    "NEW_ANNUAL_RISK_ACKNOWLEDGEMENT_FORM_INFO" as new_annual_risk_acknowledgement_form_info,
    "NEW_ARAF_DATE" as new_araf_date,
    "LATEST_ARAF_INFO" as latest_araf_info,
    "LATEST_ARAF_DATE" as latest_araf_date,
    "HAS_PERMANENT_ABSENCE_PREG_RISK_FLAG" as has_permanent_absence_preg_risk_flag,
    "LEARNING_DISABILTY" as learning_disabilty,
    "PREGNANCY" as pregnancy,
    "RISK_OF_PREGNANCY" as risk_of_pregnancy,
    "ACTION" as action,
    "RISK_GROUP" as risk_group,
    "RISK_GROUP_ORDER" as risk_group_order,
    "ACTION_ORDER" as action_order,
    "GRP_1" as grp_1,
    "GRP_2" as grp_2,
    "GRP_3" as grp_3,
    "GRP_4" as grp_4,
    "DIFF_MONTHS" as diff_months,
    "ADDITIONAL_FINDINGS" as additional_findings,
    "SPECIALTY" as specialty,
    "PATIENT_IMD_QUINTILE_19_SORT_KEY" as patient_imd_quintile_19_sort_key,
    "PATIENT_LSOA_NAME" as patient_lsoa_name,
    "COL" as col,
    "HX_FLAKE" as hx_flake
from {{ source('reference_analyst_managed', 'VALPROATE') }}
