-- Raw layer model for c_ltcs.COHORT_DATA
-- Source: "DEV__PUBLISHED_REPORTING__DIRECT_CARE"."C_LTCS"
-- Description: C-LTCS tables
-- This is a 1:1 passthrough from source with standardized column names
select
    "PATIENT_ID" as patient_id,
    "PCN_CODE" as pcn_code,
    "AGE" as age,
    "MAIN_LANGUAGE" as main_language,
    "MAIN_LANGUAGE_FLAG" as main_language_flag,
    "AE_ENCOUNTERS_SL" as ae_encounters_sl,
    "IP_ENCOUNTERS_SL" as ip_encounters_sl,
    "OP_ENCOUNTERS_SL" as op_encounters_sl,
    "GP_ENCOUNTERS_SL" as gp_encounters_sl,
    "HAS_ATRIAL_FIBRILLATION" as has_atrial_fibrillation,
    "HAS_ASTHMA" as has_asthma,
    "HAS_CANCER" as has_cancer,
    "HAS_CORONARY_HEART_DISEASE" as has_coronary_heart_disease,
    "HAS_CHRONIC_KIDNEY_DISEASE" as has_chronic_kidney_disease,
    "HAS_COPD" as has_copd,
    "HAS_CYP_ASTHMA" as has_cyp_asthma,
    "HAS_DEMENTIA" as has_dementia,
    "HAS_DEPRESSION" as has_depression,
    "HAS_DIABETES" as has_diabetes,
    "HAS_EPILEPSY" as has_epilepsy,
    "HAS_FAMILIAL_HYPERCHOLESTEROLAEMIA" as has_familial_hypercholesterolaemia,
    "HAS_GESTATIONAL_DIABETES" as has_gestational_diabetes,
    "HAS_FRAILTY" as has_frailty,
    "HAS_HEART_FAILURE" as has_heart_failure,
    "HAS_HYPERTENSION" as has_hypertension,
    "HAS_LEARNING_DISABILITY" as has_learning_disability,
    "HAS_LEARNING_DISABILITY_ALL_AGES" as has_learning_disability_all_ages,
    "HAS_NAFLD" as has_nafld,
    "HAS_NON_DIABETIC_HYPERGLYCAEMIA" as has_non_diabetic_hyperglycaemia,
    "HAS_OBESITY" as has_obesity,
    "HAS_OSTEOPOROSIS" as has_osteoporosis,
    "HAS_PERIPHERAL_ARTERIAL_DISEASE" as has_peripheral_arterial_disease,
    "HAS_PALLIATIVE_CARE" as has_palliative_care,
    "HAS_RHEUMATOID_ARTHRITIS" as has_rheumatoid_arthritis,
    "HAS_SEVERE_MENTAL_ILLNESS" as has_severe_mental_illness,
    "HAS_STROKE_TIA" as has_stroke_tia,
    "TOTAL_CONDITIONS" as total_conditions,
    "TOTAL_QOF_CONDITIONS" as total_qof_conditions,
    "TOTAL_NON_QOF_CONDITIONS" as total_non_qof_conditions,
    "CARDIOVASCULAR_CONDITIONS" as cardiovascular_conditions,
    "RESPIRATORY_CONDITIONS" as respiratory_conditions,
    "MENTAL_HEALTH_CONDITIONS" as mental_health_conditions,
    "METABOLIC_CONDITIONS" as metabolic_conditions,
    "MUSCULOSKELETAL_CONDITIONS" as musculoskeletal_conditions,
    "NEUROLOGY_CONDITIONS" as neurology_conditions,
    "GERIATRIC_CONDITIONS" as geriatric_conditions,
    "SMOKING_STATUS" as smoking_status,
    "SMOKING_RISK_SORT_KEY" as smoking_risk_sort_key,
    "BMI_CATEGORY" as bmi_category,
    "BMI_VALUE" as bmi_value,
    "BMI_RISK_SORT_KEY" as bmi_risk_sort_key,
    "ALCOHOL_STATUS" as alcohol_status,
    "ALCOHOL_RISK_SORT_KEY" as alcohol_risk_sort_key,
    "IS_CURRENTLY_PREGNANT" as is_currently_pregnant,
    "IS_OVERALL_BP_CONTROLLED" as is_overall_bp_controlled,
    "IS_MOST_RECENT_OVERALL_BP_CONTROLLED" as is_most_recent_overall_bp_controlled,
    "LATEST_SYSTOLIC_VALUE" as latest_systolic_value,
    "LATEST_DIASTOLIC_VALUE" as latest_diastolic_value,
    "LATEST_BP_DATE" as latest_bp_date,
    "CARE_PROCESSES_COMPLETED" as care_processes_completed,
    "LATEST_HBA1C_VALUE" as latest_hba1_c_value,
    "LATEST_HBA1C_DATE" as latest_hba1_c_date,
    "OP_ATT_TOT_12MO" as op_att_tot_12_mo,
    "OP_SPEC_12MO" as op_spec_12_mo,
    "OP_PROV_12MO" as op_prov_12_mo,
    "OP_PREDICTED" as op_predicted,
    "OP_OE_RATIO" as op_oe_ratio,
    "APC_12MO" as apc_12_mo,
    "APC_LOS_12MO" as apc_los_12_mo,
    "AE_T1_12MO" as ae_t1_12_mo,
    "AE_INJ_12MO" as ae_inj_12_mo,
    "AE_TOT_12MO" as ae_tot_12_mo,
    "GP_ATT_TOT_12MO" as gp_att_tot_12_mo,
    "GP_APP_TOT_12MO" as gp_app_tot_12_mo,
    "GP_DNA_TOT_12MO" as gp_dna_tot_12_mo,
    "WL_TOTAL_COUNT" as wl_total_count,
    "WL_PROVIDER_COUNT" as wl_provider_count,
    "WL_SPECIALTY_COUNT" as wl_specialty_count,
    "HAS_SAME_TFC_MULTIPLE_PROVIDERS_FLAG" as has_same_tfc_multiple_providers_flag,
    "MEDICATION_COUNT" as medication_count,
    "MEDICATION_NAME_LIST" as medication_name_list,
    "IS_POLYPHARMACY_5PLUS" as is_polypharmacy_5_plus,
    "ATTENDANCE_DIFFICULTY_SCORE" as attendance_difficulty_score
from {{ source('c_ltcs', 'COHORT_DATA') }}
