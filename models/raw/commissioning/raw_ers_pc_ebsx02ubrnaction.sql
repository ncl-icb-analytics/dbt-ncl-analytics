{{
    config(
        description="Raw layer (Primary care referrals data). 1:1 passthrough with cleaned column names. \nSource: DATA_LAKE.ERS.ebsx02UBRNAction \ndbt: source(''eRS_primary_care'', ''ebsx02UBRNAction'') \nColumns:\n  SK -> sk\n  SEQNO -> seqno\n  UBRN_ID -> ubrn_id\n  E_REFERRAL_PATHWAY_START -> e_referral_pathway_start\n  DUE_DATE -> due_date\n  SPECIALTY_CD -> specialty_cd\n  CLINIC_TYPE_CD -> clinic_type_cd\n  PRIORITY_CD -> priority_cd\n  REFERRING_CLINICIAN_ID -> referring_clinician_id\n  REFERRING_ORG_ID -> referring_org_id\n  PATIENT_ID -> patient_id\n  PATIENT_AGE -> patient_age\n  REGISTERED_CLINICIAN_ID -> registered_clinician_id\n  REGISTERED_ORG_ID -> registered_org_id\n  GUIDANCE_STATE_CD -> guidance_state_cd\n  GUIDANCE_OVERRIDE_CD -> guidance_override_cd\n  SHORTLIST_COUNT -> shortlist_count\n  ACTION_ID -> action_id\n  ACTION_DT_TM -> action_dt_tm\n  ACTION_CD -> action_cd\n  BUS_FUNCTION_CD -> bus_function_cd\n  ORG_ID -> org_id\n  PROXIED_BUS_FUNCTION_CD -> proxied_bus_function_cd\n  PROXIED_ORG_ID -> proxied_org_id\n  ACTION_REASON_CD -> action_reason_cd\n  SERVICE_ID -> service_id\n  APPT_DT_TM -> appt_dt_tm\n  SERVICE_DEFINED_FREEZE_TIME_BREACH -> service_defined_freeze_time_breach\n  PRIORITY_TIME_LIMIT_BREACH -> priority_time_limit_breach\n  REBOOKED_TO_ACTION_ID -> rebooked_to_action_id\n  NAMED_CLINICIAN_ID -> named_clinician_id\n  INITIAL_UBRN_ID -> initial_ubrn_id\n  PREVIOUS_UBRN_ID -> previous_ubrn_id\n  ALLOCATED_CLINICIAN_ID -> allocated_clinician_id\n  USER_ID -> user_id\n  PROXY_USER_ID -> proxy_user_id\n  CLINICAL_ASSESSMENT_OUTCOME_CD -> clinical_assessment_outcome_cd\n  PROBLEM_CD -> problem_cd\n  PROBLEM_STATUS_CD -> problem_status_cd\n  REQUESTED_PROCEDURE_CD -> requested_procedure_cd\n  SEARCHED_CLINICAL_TERM_CD -> searched_clinical_term_cd\n  SEARCHED_ORGANISATION_OR_SITE_CD -> searched_organisation_or_site_cd\n  SEARCHED_AGE_SEX_IND -> searched_age_sex_ind\n  SEARCHED_IWT -> searched_iwt\n  SEARCHED_DISTANCE -> searched_distance\n  PATIENTS_PARTIAL_POSTCODE -> patients_partial_postcode\n  UBRN -> ubrn\n  INITIAL_UBRN -> initial_ubrn\n  PREVIOUS_UBRN -> previous_ubrn\n  NEXT_UBRN -> next_ubrn\n  IWT -> iwt\n  PATIENT_SEX_CD -> patient_sex_cd\n  TEST_PATIENT_IND -> test_patient_ind\n  CONTENT_SENSITIVE_IND -> content_sensitive_ind\n  WEB_BASED_REFERRER_IND -> web_based_referrer_ind\n  AR_STATUS_CD -> ar_status_cd\n  ORIGINAL_DUE_DATE -> original_due_date\n  ORIGINAL_PRIORITY_CD -> original_priority_cd\n  ACTION_DESC -> action_desc\n  ACTION_REASON_DESC -> action_reason_desc\n  AR_STATUS_DESC -> ar_status_desc\n  BUS_FUNCTION_DESC -> bus_function_desc\n  CLINICAL_ASSESS_OUTCOME_DESC -> clinical_assess_outcome_desc\n  CLINIC_TYPE_DESC -> clinic_type_desc\n  ORIGINAL_PRIORITY_DESC -> original_priority_desc\n  PATIENT_SEX_DESC -> patient_sex_desc\n  PRIORITY_DESC -> priority_desc\n  PROXIED_BUS_FUNCTION_DESC -> proxied_bus_function_desc\n  SEARCHED_CLINICAL_TERM_DESC -> searched_clinical_term_desc\n  SEARCHED_ORG_OR_SITE_DESC -> searched_org_or_site_desc\n  SPECIALTY_DESC -> specialty_desc\n  REFERRER_ORG_NAME -> referrer_org_name\n  REFERRER_COMMISSIONER_ID -> referrer_commissioner_id\n  REFERRER_COMMISSIONER_NAME -> referrer_commissioner_name\n  REFERRER_COMMISSIONER_FOUND -> referrer_commissioner_found\n  ORG_NAME -> org_name\n  COMMISSIONER_ID -> commissioner_id\n  COMMISSIONER_NAME -> commissioner_name\n  COMMISSIONER_FOUND -> commissioner_found\n  PROXIED_ORG_NAME -> proxied_org_name\n  PROXIED_COMMISSIONER_ID -> proxied_commissioner_id\n  PROXIED_COMMISSIONER_NAME -> proxied_commissioner_name\n  PROXIED_COMMISSIONER_FOUND -> proxied_commissioner_found\n  SERVICE_NAME -> service_name\n  APPT_TYPE_CD -> appt_type_cd\n  APPT_TYPE_DESC -> appt_type_desc\n  LOCATION_ORG_ID -> location_org_id\n  LOCATION_ORG_NAME -> location_org_name\n  PROVIDER_ORG_ID -> provider_org_id\n  PROVIDER_ORG_NAME -> provider_org_name\n  PROVIDER_ORG_TYPE_CODE -> provider_org_type_code\n  PROVIDER_ORG_TYPE_DESC -> provider_org_type_desc\n  NHS_NUMBER Pseudo -> nhs_number_pseudo\n  PATIENTS_LSOA -> patients_lsoa\n  PATIENTS_POSTCODE Pseudo -> patients_postcode_pseudo\n  PATIENTS_REG_GP_PRACTICE_ID -> patients_reg_gp_practice_id\n  PATIENTS_REG_GP_PRACTICE_NAME -> patients_reg_gp_practice_name\n  PATIENTS_CCG_OF_RESIDENCE_ID -> patients_ccg_of_residence_id\n  PATIENTS_CCG_OF_RESIDENCE_NAME -> patients_ccg_of_residence_name\n  PATIENTS_CCG_OF_REGISTRATION_ID -> patients_ccg_of_registration_id\n  PATIENTS_CCG_OF_REGISTRATION_NAME -> patients_ccg_of_registration_name\n  PATIENTS_LA_OF_RESIDENCE_ID -> patients_la_of_residence_id\n  PATIENTS_LA_OF_RESIDENCE_NAME -> patients_la_of_residence_name\n  PATIENTS_LA_OF_REGISTRATION_ID -> patients_la_of_registration_id\n  PATIENTS_LA_OF_REGISTRATION_NAME -> patients_la_of_registration_name\n  AREA_TEAM_CODE_OF_RESIDENCE -> area_team_code_of_residence\n  AREA_TEAM_NAME_OF_RESIDENCE -> area_team_name_of_residence\n  AREA_TEAM_CODE_OF_REGISTRATION -> area_team_code_of_registration\n  AREA_TEAM_NAME_OF_REGISTRATION -> area_team_name_of_registration\n  ACCEPTS_ADVICE_REQUESTS -> accepts_advice_requests\n  ACCEPTS_APPOINTMENT_REQUESTS -> accepts_appointment_requests\n  ACCEPTS_TRIAGE_REQUESTS -> accepts_triage_requests\n  SERVICE_SPECIALTY_CD -> service_specialty_cd\n  SERVICE_SPECIALTY_DESC -> service_specialty_desc\n  dmicImportLogId -> dmic_import_log_id\n  UniqSubmissionID -> uniq_submission_id\n  Unique_MonthID -> unique_month_id\n  ebsx02_ID -> ebsx02_id\n  dmicSystemId -> dmic_system_id\n  dmicDateAdded -> dmic_date_added\n  dmicCCGofRegistration -> dmic_ccg_of_registration\n  dmicCCGofResidence -> dmic_ccg_of_residence\n  dmicCCGofReferrer -> dmic_ccg_of_referrer\n  dmicCCGofProvider -> dmic_ccg_of_provider"
    )
}}
select
    "SK" as sk,
    "SEQNO" as seqno,
    "UBRN_ID" as ubrn_id,
    "E_REFERRAL_PATHWAY_START" as e_referral_pathway_start,
    "DUE_DATE" as due_date,
    "SPECIALTY_CD" as specialty_cd,
    "CLINIC_TYPE_CD" as clinic_type_cd,
    "PRIORITY_CD" as priority_cd,
    "REFERRING_CLINICIAN_ID" as referring_clinician_id,
    "REFERRING_ORG_ID" as referring_org_id,
    "PATIENT_ID" as patient_id,
    "PATIENT_AGE" as patient_age,
    "REGISTERED_CLINICIAN_ID" as registered_clinician_id,
    "REGISTERED_ORG_ID" as registered_org_id,
    "GUIDANCE_STATE_CD" as guidance_state_cd,
    "GUIDANCE_OVERRIDE_CD" as guidance_override_cd,
    "SHORTLIST_COUNT" as shortlist_count,
    "ACTION_ID" as action_id,
    "ACTION_DT_TM" as action_dt_tm,
    "ACTION_CD" as action_cd,
    "BUS_FUNCTION_CD" as bus_function_cd,
    "ORG_ID" as org_id,
    "PROXIED_BUS_FUNCTION_CD" as proxied_bus_function_cd,
    "PROXIED_ORG_ID" as proxied_org_id,
    "ACTION_REASON_CD" as action_reason_cd,
    "SERVICE_ID" as service_id,
    "APPT_DT_TM" as appt_dt_tm,
    "SERVICE_DEFINED_FREEZE_TIME_BREACH" as service_defined_freeze_time_breach,
    "PRIORITY_TIME_LIMIT_BREACH" as priority_time_limit_breach,
    "REBOOKED_TO_ACTION_ID" as rebooked_to_action_id,
    "NAMED_CLINICIAN_ID" as named_clinician_id,
    "INITIAL_UBRN_ID" as initial_ubrn_id,
    "PREVIOUS_UBRN_ID" as previous_ubrn_id,
    "ALLOCATED_CLINICIAN_ID" as allocated_clinician_id,
    "USER_ID" as user_id,
    "PROXY_USER_ID" as proxy_user_id,
    "CLINICAL_ASSESSMENT_OUTCOME_CD" as clinical_assessment_outcome_cd,
    "PROBLEM_CD" as problem_cd,
    "PROBLEM_STATUS_CD" as problem_status_cd,
    "REQUESTED_PROCEDURE_CD" as requested_procedure_cd,
    "SEARCHED_CLINICAL_TERM_CD" as searched_clinical_term_cd,
    "SEARCHED_ORGANISATION_OR_SITE_CD" as searched_organisation_or_site_cd,
    "SEARCHED_AGE_SEX_IND" as searched_age_sex_ind,
    "SEARCHED_IWT" as searched_iwt,
    "SEARCHED_DISTANCE" as searched_distance,
    "PATIENTS_PARTIAL_POSTCODE" as patients_partial_postcode,
    "UBRN" as ubrn,
    "INITIAL_UBRN" as initial_ubrn,
    "PREVIOUS_UBRN" as previous_ubrn,
    "NEXT_UBRN" as next_ubrn,
    "IWT" as iwt,
    "PATIENT_SEX_CD" as patient_sex_cd,
    "TEST_PATIENT_IND" as test_patient_ind,
    "CONTENT_SENSITIVE_IND" as content_sensitive_ind,
    "WEB_BASED_REFERRER_IND" as web_based_referrer_ind,
    "AR_STATUS_CD" as ar_status_cd,
    "ORIGINAL_DUE_DATE" as original_due_date,
    "ORIGINAL_PRIORITY_CD" as original_priority_cd,
    "ACTION_DESC" as action_desc,
    "ACTION_REASON_DESC" as action_reason_desc,
    "AR_STATUS_DESC" as ar_status_desc,
    "BUS_FUNCTION_DESC" as bus_function_desc,
    "CLINICAL_ASSESS_OUTCOME_DESC" as clinical_assess_outcome_desc,
    "CLINIC_TYPE_DESC" as clinic_type_desc,
    "ORIGINAL_PRIORITY_DESC" as original_priority_desc,
    "PATIENT_SEX_DESC" as patient_sex_desc,
    "PRIORITY_DESC" as priority_desc,
    "PROXIED_BUS_FUNCTION_DESC" as proxied_bus_function_desc,
    "SEARCHED_CLINICAL_TERM_DESC" as searched_clinical_term_desc,
    "SEARCHED_ORG_OR_SITE_DESC" as searched_org_or_site_desc,
    "SPECIALTY_DESC" as specialty_desc,
    "REFERRER_ORG_NAME" as referrer_org_name,
    "REFERRER_COMMISSIONER_ID" as referrer_commissioner_id,
    "REFERRER_COMMISSIONER_NAME" as referrer_commissioner_name,
    "REFERRER_COMMISSIONER_FOUND" as referrer_commissioner_found,
    "ORG_NAME" as org_name,
    "COMMISSIONER_ID" as commissioner_id,
    "COMMISSIONER_NAME" as commissioner_name,
    "COMMISSIONER_FOUND" as commissioner_found,
    "PROXIED_ORG_NAME" as proxied_org_name,
    "PROXIED_COMMISSIONER_ID" as proxied_commissioner_id,
    "PROXIED_COMMISSIONER_NAME" as proxied_commissioner_name,
    "PROXIED_COMMISSIONER_FOUND" as proxied_commissioner_found,
    "SERVICE_NAME" as service_name,
    "APPT_TYPE_CD" as appt_type_cd,
    "APPT_TYPE_DESC" as appt_type_desc,
    "LOCATION_ORG_ID" as location_org_id,
    "LOCATION_ORG_NAME" as location_org_name,
    "PROVIDER_ORG_ID" as provider_org_id,
    "PROVIDER_ORG_NAME" as provider_org_name,
    "PROVIDER_ORG_TYPE_CODE" as provider_org_type_code,
    "PROVIDER_ORG_TYPE_DESC" as provider_org_type_desc,
    "NHS_NUMBER Pseudo" as nhs_number_pseudo,
    "PATIENTS_LSOA" as patients_lsoa,
    "PATIENTS_POSTCODE Pseudo" as patients_postcode_pseudo,
    "PATIENTS_REG_GP_PRACTICE_ID" as patients_reg_gp_practice_id,
    "PATIENTS_REG_GP_PRACTICE_NAME" as patients_reg_gp_practice_name,
    "PATIENTS_CCG_OF_RESIDENCE_ID" as patients_ccg_of_residence_id,
    "PATIENTS_CCG_OF_RESIDENCE_NAME" as patients_ccg_of_residence_name,
    "PATIENTS_CCG_OF_REGISTRATION_ID" as patients_ccg_of_registration_id,
    "PATIENTS_CCG_OF_REGISTRATION_NAME" as patients_ccg_of_registration_name,
    "PATIENTS_LA_OF_RESIDENCE_ID" as patients_la_of_residence_id,
    "PATIENTS_LA_OF_RESIDENCE_NAME" as patients_la_of_residence_name,
    "PATIENTS_LA_OF_REGISTRATION_ID" as patients_la_of_registration_id,
    "PATIENTS_LA_OF_REGISTRATION_NAME" as patients_la_of_registration_name,
    "AREA_TEAM_CODE_OF_RESIDENCE" as area_team_code_of_residence,
    "AREA_TEAM_NAME_OF_RESIDENCE" as area_team_name_of_residence,
    "AREA_TEAM_CODE_OF_REGISTRATION" as area_team_code_of_registration,
    "AREA_TEAM_NAME_OF_REGISTRATION" as area_team_name_of_registration,
    "ACCEPTS_ADVICE_REQUESTS" as accepts_advice_requests,
    "ACCEPTS_APPOINTMENT_REQUESTS" as accepts_appointment_requests,
    "ACCEPTS_TRIAGE_REQUESTS" as accepts_triage_requests,
    "SERVICE_SPECIALTY_CD" as service_specialty_cd,
    "SERVICE_SPECIALTY_DESC" as service_specialty_desc,
    "dmicImportLogId" as dmic_import_log_id,
    "UniqSubmissionID" as uniq_submission_id,
    "Unique_MonthID" as unique_month_id,
    "ebsx02_ID" as ebsx02_id,
    "dmicSystemId" as dmic_system_id,
    "dmicDateAdded" as dmic_date_added,
    "dmicCCGofRegistration" as dmic_ccg_of_registration,
    "dmicCCGofResidence" as dmic_ccg_of_residence,
    "dmicCCGofReferrer" as dmic_ccg_of_referrer,
    "dmicCCGofProvider" as dmic_ccg_of_provider
from {{ source('eRS_primary_care', 'ebsx02UBRNAction') }}
