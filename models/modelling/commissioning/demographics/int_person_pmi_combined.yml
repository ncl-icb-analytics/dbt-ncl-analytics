version: 2

models:
  - name: int_person_pmi_combined
    description: >
      Combines available int_person_pmi_dataset tables into single combined table.
      Each field has its own criteria for prioritising datasets.
    config:
      meta:
        owner:
          name: Jake Kealey
    columns:
      - name: sk_patient_id
        description: Surrogate key for patient
        data_tests:
          - not_null
          - unique

      - name: gender_source
        description: Dataset used for field

      - name: gender_code
        description: Gender code

      - name: gender_event_date
        description: Date of record in source dataset

      - name: dob_source
        description: Dataset used for field

      - name: date_of_birth
        description: Patient date of birth (rounded to 1st of month)

      - name: dob_event_date
        description: Date of record in source dataset

      - name: death_source
        description: Dataset used for field

      - name: date_of_death
        description: Date of death (NULL if no recorded death or unknown)

      - name: death_event_date
        description: Date of record in source dataset

      - name: ethnicity_source
        description: Dataset used for field

      - name: ethnicity_code
        description: Ethnicity code

      - name: ethnicity_event_date
        description: Date of record in source dataset

      - name: preferred_language_source
        description: Dataset used for field

      - name: preferred_language_code
        description: Preferred language shorthand

      - name: preferred_language_event_date
        description: Date of record in source dataset

      - name: interpreter_required_source
        description: Dataset used for field

      - name: interpreter_required
        description: Whether interpreter is required

      - name: interpreter_event_date
        description: Date of record in source dataset

      - name: lsoa_source
        description: Dataset used for field

      - name: lsoa_21
        description: Lower Super Output Area code (2021 Census)

      - name: residence_event_date
        description: Date of record in source dataset

      - name: practice_source
        description: Dataset used for field

      - name: practice_code
        description: GP practice code

      - name: registered_event_date
        description: Date of record in source dataset
