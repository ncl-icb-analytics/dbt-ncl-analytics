version: 2

models:
  - name: int_sus_op_encounters
    description: "Event history for outpatient encounters from SUS data"
    columns:
      - name: visit_occurrence_id
        data_type: number
        description: "Primary key for the encounter within SUS"
        tests:
          - unique
          - not_null

      - name: sk_patient_id
        data_type: varchar
        description: "Common commissioning patient identifier"
        tests:
          - not_null

      - name: source
        data_type: varchar
        description: "Commissioning data source"

      - name: organisation_id
        data_type: varchar
        description: "Provider organisation identifier"

      - name: organisation_name
        data_type: varchar
        description: "Provider organisation name"

      - name: site_id
        data_type: varchar
        description: "Site identifier"

      - name: site_name
        data_type: varchar
        description: "Site name"

      - name: start_date
        data_type: timestamp_ntz
        description: "The date the appointment took place or will take place if in the future"

      - name: expected_duration
        data_type: varchar
        description: "Expected Duration of Appointment"

      - name: appointment_outcome
        data_type: varchar
        description: "Code: Records the action resulting from the attendance such asmaking another appointment or ending the series of consultations by discharging the patient. It does not record clinical outcome."
     
      - name: outcome_desc
        data_type: varchar
        description: "Desc: Records the action resulting from the attendance such asmaking another appointment or ending the series of consultations by discharging the patient. It does not record clinical outcome."

      - name: appointment_attended_or_dna
        data_type: varchar
        description: "Code: An indication of whether an appointment took place or not and if not, whether advance warning was given"

      - name: appointment_attendance_outcome_desc
        data_type: varchar
        description: "Desc: An indication of whether an appointment took place or not and if not, whether advance warning was given"

      - name: appointment_first_attendance
        data_type: varchar
        description: "Code: Flag for whether the appointment was a first attendance"
     
      - name: first_attendance_desc
        data_type: varchar
        description: "Desc: Flag for whether the appointment was a first attendance"

      - name: pod
        data_type: varchar
        description: "Point of delivery, based on HRG code"

      - name: main_specialty_code
        data_type: varchar
        description: "Code: The specialty in which the consultant is contracted or recognised and the code identifies a specialty as designated by Royal Colleges."

      - name: main_specialty_name
        data_type: varchar
        description: "Desc: The specialty in which the consultant is contracted or recognised and the code identifies a specialty as designated by Royal Colleges."

      - name: main_specialty_category
        data_type: varchar
        description: "Grouping: The specialty in which the consultant is contracted or recognised and the code identifies a specialty as designated by Royal Colleges."

      - name: referral_acuity
        data_type: number
        description: "Code: The priority of a request for services: in the case of services to be provided by a consultant, it is as assessed by or on behalf of the consultant"

      - name: referral_acuity_desc
        data_type: varchar
        description: "Desc: The priority of a request for services: in the case of services to be provided by a consultant, it is as assessed by or on behalf of the consultant"

      - name: treatment_function_code
        data_type: varchar
        description: "TREATMENT FUNCTION CODE is recorded to report the specialised service within which the PATIENT is treated. It is based on MAIN SPECIALTY but also includes approved sub-specialties and treatment specialties used by lead CARE PROFESSIONALS including CONSULTANTS. TREATMENT FUNCTION, rather than the Royal College or Faculty specialty, is required on most activity returns and in the Commissioning Data Sets."

      - name: treatment_function_code_desc
        data_type: varchar
        description: "TREATMENT FUNCTION CODE is recorded to report the specialised service within which the PATIENT is treated. It is based on MAIN SPECIALTY but also includes approved sub-specialties and treatment specialties used by lead CARE PROFESSIONALS including CONSULTANTS. TREATMENT FUNCTION, rather than the Royal College or Faculty specialty, is required on most activity returns and in the Commissioning Data Sets."

      - name: spec_comm
        data_type: varchar
        description: "Specialised Commission Code"

      - name: spec_comm_flag
        data_type: varchar
        description: "Specialised Commission Flag"

      - name: core_hrg_code
        data_type: varchar
        description: "HRG code type associated with the encounter"

      - name: core_hrg_desc
        data_type: varchar
        description: "HRG code type associated with the encounter"

      - name: core_hrg_chapter
        data_type: varchar
        description: "HRG code type associated with the encounter"

      - name: core_hrg_chapter_desc
        data_type: varchar
        description: "HRG code type associated with the encounter"

      - name: cost
        data_type: number
        description: "The final calculated national SUS listed price"

      - name: age_at_event
        data_type: number
        description: "The age in years of the patient derived by the sender as at the relevant CDS activity date of the CDS type."

      - name: gender_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: gender_desc_at_event
        data_type: varchar
        description: ""

      - name: ethnicity_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: ethnicity_desc_at_event
        data_type: varchar
        description: ""

      - name: postcode_district_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: lsoa_11_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: lad_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: imd_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: reg_practice_at_event
        data_type: varchar
        description: "Ambiguous"

      - name: visit_occurrence_type
        data_type: varchar
        description: ""
