version: 2

models:
  - name: int_sus_apc_procedure_hrg
    description: "A table of APC procedures with HRG coding details for commissioning analysis includes the unbundled HRGs for each episode and the core HRG for the episode."
    columns:
      - name: procedure_id
        data_type: varchar
        description: "Unique surrogate identifier for the procedure record"
        tests:
          - not_null
          - unique

      - name: date
        data_type: timestamp_ntz
        description: "Episode start date."

      - name: visit_occurrence_id
        data_type: number
        description: "Spell primary key identifier."

      - name: visit_occurrence_type
        data_type: varchar
        description: "Where in the system the procedure took place"

      - name: episodes_id
        data_type: number
        description: "Unique identifier for the episode within the spell."

      - name: problem_order
        data_type: number
        description: "Order of the unbundled HRG within the episode, 0 indicates the core HRG."

      - name: sk_patient_id
        data_type: varchar
        description: "Unique patient identifier."

      - name: organisation_id
        data_type: varchar
        description: "ODS organisation code of the service provider (limited to type 41)."

      - name: organisation_name
        data_type: varchar
        description: "Name of the organisation (type 41)"

      - name: site_id
        data_type: varchar
        description: "ODS code of the service provider site"

      - name: site_name
        data_type: varchar
        description: "Name of the service provider site"

      - name: source_concept_code
        data_type: varchar
        description: "HRG code of the procedure"

      - name: concept_name
        data_type: varchar
        description: "HRG description of the procedure"

      - name: concept_vocabulary
        data_type: varchar
        description: "Type of concept used"

      - name: hrg_chapter
        data_type: varchar
        description: ""

      - name: hrg_subchapter
        data_type: varchar
        description: ""