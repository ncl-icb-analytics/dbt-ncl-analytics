version: 2
models:
  - name: int_valproate_medications_all
    description: 'Valproate medication orders for seizure management and bipolar disorder
      with pregnancy safety monitoring.

      One row per medication order with dual matching logic, high teratogenic risk
      flagging, and dose categorisation for bioequivalence monitoring.'

    config:
      meta:
        owner:
          name: EddieDavison92
    columns:
      - name: medication_order_id
        description: 'Unique identifier for the medication order - primary key'
        tests:
          - unique
          - not_null

      - name: medication_statement_id
        description: 'Unique identifier for the medication statement'

      - name: person_id
        description: 'Patient identifier'

      - name: order_date
        description: 'Date when valproate medication was ordered'

      - name: order_medication_name
        description: 'Name of the valproate medication as ordered'

      - name: order_dose
        description: 'Prescribed dose of the valproate medication'

      - name: order_quantity_value
        description: 'Quantity value of the valproate medication ordered'

      - name: order_quantity_unit
        description: 'Unit of measurement for the medication quantity'

      - name: order_duration_days
        description: 'Duration of the medication order in days'

      - name: statement_medication_name
        description: 'Name of the valproate medication in the statement record'

      - name: mapped_concept_code
        description: 'Standardised clinical code for the valproate medication'

      - name: mapped_concept_display
        description: 'Human-readable description of the valproate medication code'

      - name: mapped_concept_id
        description: 'Unique identifier for the mapped concept'

      - name: valproate_product_term
        description: 'Valproate product term from reference data'

      - name: bnf_code
        description: 'BNF code for the valproate medication'

      - name: bnf_name
        description: 'BNF name for the valproate medication'

      - name: matched_on_name
        description: 'Flag indicating medication matched on name pattern'

      - name: matched_on_concept_id
        description: 'Flag indicating medication matched on concept ID'

      - name: valproate_product_type
        description: 'Valproate product type (SODIUM_VALPROATE, VALPROIC_ACID, EPILIM,
          DEPAKOTE, OTHER_VALPROATE)'

      - name: is_high_teratogenic_risk
        description: 'Flag indicating high teratogenic risk (always true for valproate)'

      - name: clinical_indication
        description: 'Clinical indication category (ANTI_EPILEPTIC, MOOD_STABILISER,
          UNSPECIFIED)'

      - name: dose_category
        description: 'Dose categorisation (LOW_DOSE, MODERATE_DOSE, HIGH_DOSE, UNKNOWN_DOSE)'

      - name: formulation_type
        description: 'Formulation type (TABLET, CAPSULE, LIQUID, MODIFIED_RELEASE,
          UNKNOWN_FORMULATION)'

      - name: is_recent_3m
        description: 'Flag indicating order within the last 3 months'

      - name: is_recent_6m
        description: 'Flag indicating order within the last 6 months'

      - name: is_recent_12m
        description: 'Flag indicating order within the last 12 months'

      - name: current_practice_id
        description: 'Current practice identifier for the patient'

      - name: total_patients
        description: 'Total patient count reference'
