version: 2
models:
  - name: int_valproate_medications_6m_latest
    description: 'Most recent valproate medication order per person from the last 6 months for pregnancy safety monitoring.

      One row per person with latest valproate order, including product classification and recency tracking for teratogenicity risk assessment.'

    columns:
      - name: person_id
        description: 'Patient identifier'

      - name: most_recent_order_date
        description: 'Date of the most recent valproate order in the last 6 months'

      - name: medication_order_id
        description: 'Unique identifier for the latest medication order'

      - name: medication_statement_id
        description: 'Unique identifier for the latest medication statement'

      - name: order_medication_name
        description: 'Name of the valproate medication as ordered'

      - name: order_dose
        description: 'Prescribed dose of the valproate medication'

      - name: order_quantity_value
        description: 'Quantity value of the valproate medication ordered'

      - name: order_quantity_unit
        description: 'Unit of measurement for the medication quantity'

      - name: order_duration_days
        description: 'Duration of the medication order in days'

      - name: statement_medication_name
        description: 'Name of the valproate medication in the statement record'

      - name: mapped_concept_code
        description: 'Standardised clinical code for the valproate medication'

      - name: mapped_concept_display
        description: 'Human-readable description of the valproate medication code'

      - name: valproate_product_term
        description: 'Valproate product classification (EPILIM, CONVULEX, DEPAKOTE, EPISENTA, VALPROATE_GENERIC, OTHER_VALPROATE)'

      - name: recent_order_count
        description: 'Total number of valproate orders for this person in the last 6 months'
