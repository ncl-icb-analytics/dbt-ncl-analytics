version: 2
models:
  - name: int_frailty_diagnoses_all
    description: 'Frailty diagnosis observations with severity classification for care planning and risk assessment.

      Key Features:

      • Uses FRAILTY_DX cluster for diagnosis identification

      • Classifies severity levels (mild, moderate, severe, unknown)

      • Supports frailty register data collection

      • Enables care planning for frail elderly populations

      Purpose: Provide observation-level data for frailty assessment and intervention tracking.'
    tests:
      - dbt_utils.at_least_one:
          column_name: id
      - cluster_ids_exist:
          cluster_ids: FRAILTY_DX
    columns:
      - name: id
        description: 'Unique identifier for the clinical observation'
        tests:
          - unique
          - not_null
      - name: person_id
        description: 'Unique identifier for the person'
      - name: clinical_effective_date
        description: 'Date when the frailty observation was recorded'
      - name: concept_code
        description: 'Clinical code for the frailty diagnosis'
      - name: concept_display
        description: 'Human-readable description of the frailty diagnosis'
      - name: source_cluster_id
        description: 'Source cluster identifier (FRAILTY_DX for frailty diagnoses)'
      - name: is_diagnosis_code
        description: 'Boolean flag indicating diagnosis code (always TRUE for frailty observations)'
      - name: frailty_severity
        description: 'Severity classification: Mild (925791000000100), Moderate (925831000000107), Severe (925861000000102), or Unknown'
      - name: frailty_observation_type
        description: 'Type of frailty observation (always "Frailty Diagnosis")'