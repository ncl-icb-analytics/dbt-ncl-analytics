version: 2
models:
  - name: int_ltc_lcs_af_medications
    description: 'Atrial fibrillation-relevant medications for Long Term Conditions
      case finding measures AF_61 and AF_62.

      One row per medication order with differential time windows: 6 months for anticoagulants/protamine,
      3 months for other medications. Uses cluster IDs: ORAL_ANTICOAGULANT_2_8_2,
      AF_MEDICATIONS, DIGOXIN_MEDICATIONS, CARDIAC_GLYCOSIDES, PROTAMINE_MEDICATIONS.'
    config:
      meta:
        owner:
          name: EddieDavison92
    tests:
      - dbt_utils.at_least_one:
          column_name: person_id
      - cluster_ids_exist:
          cluster_ids: 
            ORAL_ANTICOAGULANT_2_8_2,AF_MEDICATIONS,DIGOXIN_MEDICATIONS,CARDIAC_GLYCOSIDES,PROTAMINE_MEDICATIONS
    columns:
      - name: person_id
        tests:
          - not_null
