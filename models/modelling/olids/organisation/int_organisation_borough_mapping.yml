version: 2
models:
  - name: int_organisation_borough_mapping
    description: 'Organisation borough mapping for North Central London practices
      and PCNs with historic CCG relationships.

      Key Features:

      • Maps practices to boroughs using historic CCG relationships via organisational
      hierarchy

      • Maps PCNs to boroughs based on majority practice allocation

      • Hardcoded CCG-to-borough mapping: 07R→Camden, 08H→Islington, 07M→Barnet, 07X→Enfield,
      08D→Haringey

      • Special handling for cross-borough services (Medicus Select Care Y03103 assigned
      to Enfield)

      • Uses most recent relationship for each practice-borough combination

      Purpose: Provide borough context for North Central London practices and PCNs
      for geographic analysis.'
    config:
      meta:
        owner:
          name: EddieDavison92
    columns:
      - name: practice_code
        description: 'GP practice identifier. Not unique - practices may appear multiple times if they have multiple PCN relationships.'
        tests:
          - not_null
      - name: borough_registered
        description: 'Borough assignment for the practice based on historic CCG relationships'
      - name: practice_historic_ccg
        description: 'Historic CCG code used for borough mapping (07R, 08H, 07M, 07X,
          08D)'
      - name: network_code
        description: 'Primary Care Network (PCN) identifier that the practice belongs
          to'
      - name: pcn_borough
        description: 'Borough assignment for the PCN based on majority practice allocation'
      - name: pcn_borough_practice_count
        description: 'Number of practices within the PCN assigned to this borough'
