version: 2

models:
  - name: semantic_olids_population
    description: |
      OLIDS Population Health Semantic View
      ======================================
      
      Comprehensive semantic model for NCL population health analysis combining
      demographics, conditions, and person status into a unified semantic layer.
      
      **⚠️ Data Governance:** Includes OLIDS data - don't publish/share outputs without DAC approval.
      
      **Purpose:**
      - Enable natural language queries via Snowflake Cortex Analyst
      - Provide governed metric definitions for population health reporting
      - Support self-service analytics without requiring knowledge of table joins
      
      **Grain:** One row per person (current state)
      
      **Tables Included:**
      - `dim_person_demographics`: Core demographics, registration, geography
      - `dim_person_conditions`: Boolean flags for all conditions + summary counts
      - `dim_person_status_summary`: Vulnerability factors, risk behaviours, polypharmacy, data sharing
      
      **Example Queries:**
      
      ```sql
      -- Get diabetes prevalence by borough
      SELECT *
      FROM SEMANTIC_VIEW(
        REPORTING.SEMANTIC.SEMANTIC_OLIDS_POPULATION
        METRICS diabetes_count, patient_count
        DIMENSIONS borough_registered
      )
      
      -- Average conditions by deprivation
      SELECT *
      FROM SEMANTIC_VIEW(
        REPORTING.SEMANTIC.SEMANTIC_OLIDS_POPULATION
        METRICS avg_conditions_per_patient, patient_count
        DIMENSIONS imd_quintile_25
      )
      
      -- Vulnerability analysis by PCN
      SELECT *
      FROM SEMANTIC_VIEW(
        REPORTING.SEMANTIC.SEMANTIC_OLIDS_POPULATION
        METRICS care_home_resident_count, housebound_count, polypharmacy_5plus_count
        DIMENSIONS pcn_name
        WHERE is_active = TRUE
      )
      ```

    config:
      materialized: semantic_view
      schema: SEMANTIC
      meta:
        owner:
          name: EddieDavison92
