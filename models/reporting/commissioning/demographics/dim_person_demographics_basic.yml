version: 2

models:
  - name: dim_person_demographics_basic
    description: >
      Dimensional table providing comprehensive demographic information for persons,
      including gender, ethnicity, residence and registration details enriched with
      reference data lookups.

      Documentation available: https://github.com/ncl-icb-analytics/dbt-ncl-analytics/blob/main/docs/model_documentation/dim_person_demographics_basic.md
    config:
      meta:
        owner:
          name: Jake Kealey
    columns:
      - name: sk_patient_id
        description: Surrogate key for patient
        data_tests:
          - not_null
          - unique

      - name: gender_code
        description: Gender code

      - name: gender
        description: Gender description

      - name: date_of_birth
        description: Patient date of birth (rounded to 1st of month)

      - name: date_of_death
        description: Patient date of death (NULL if no recorded death or 
          unknown)

      - name: ethnicity_code
        description: Ethnicity (BK) code

      - name: ethnicity_desc
        description: Full ethnicity description

      - name: ethnicity
        description: Ethnicity group

      - name: ethnicity_detail
        description: Ethnicity group description

      - name: flag_current_ncl_residence
        description: Flag indicating if patient is part of current NCL resident 
          population

      - name: record_residence_start_date
        description: Start date of current residence record

      - name: lsoa_2021_code
        description: Lower Super Output Area code (2021 Census)

      - name: lsoa_2021_name
        description: Lower Super Output Area name (2021 Census)

      - name: ward_2025_code
        description: Ward code (2025)

      - name: ward_2025_name
        description: Ward name (2025)

      - name: residence_borough
        description: Local authority name where patient resides

      - name: residence_neighbourhood_code
        description: NCL neighbourhood code for residence location

      - name: residence_neighbourhood_name
        description: NCL neighbourhood name for residence location

      - name: residence_imd_decile
        description: Index of Multiple Deprivation decile for residence location

      - name: flag_current_ncl_registered
        description: Flag indicating if patient is part of current NCL 
          registered population

      - name: record_registered_start_date
        description: Start date of current registration record

      - name: practice_code
        description: GP practice code

      - name: practice_name
        description: GP practice name

      - name: pcn_code
        description: Primary Care Network code

      - name: pcn_name
        description: Primary Care Network name

      - name: icb_code
        description: Integrated Care Board code

      - name: icb_name
        description: Integrated Care Board name

      - name: registered_borough
        description: Borough where GP practice is located (NCL only)

      - name: registered_neighbourhood_code
        description: NCL neighbourhood code for registered GP practice

      - name: registered_neighbourhood_name
        description: NCL neighbourhood name for registered GP practice

      - name: preferred_language
        description: Patient preferred language

      - name: interpreter_required
        description: Flag indicating if patient requires an interpreter
