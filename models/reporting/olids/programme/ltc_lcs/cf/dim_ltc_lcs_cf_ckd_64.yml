version: 2
models:
  - name: dim_ltc_lcs_cf_ckd_64
    description: 'Patients aged 17+ with high-risk conditions and no eGFR in 12 months.

      Conditions: AKI (3 years), BPH/gout, lithium/nephrotoxic medications (6
      months), or validated microhaematuria (UACR correlation, negative urine
      test exclusion).

      One row per person with condition flags and eGFR monitoring gap.'
    config:
      meta:
        indicator:
          id: "LTC_LCS_CF_CKD_64"
          type: "CASE_FINDING"
          category: "CKD"
          clinical_domain: "Chronic Kidney Disease Case Finding"
          name_short: "Overdue eGFR"
          description_short: "High-risk patients without eGFR monitoring in 12 months"
          description_long: >
            Age 17+, high-risk conditions without eGFR in 12m. AKI (3y),
            BPH/gout, lithium/nephrotoxics (6m), or microhaematuria.
          is_qof: false
          source_column: "person_id"
          sort_order: "LTC_LCS_CKD_64"
          usage_contexts:
            - "LTC_LCS_DASHBOARD"
            - "CASE_FINDING_PROGRAMME"
          code_clusters:
            - cluster_id: "CKD_ACUTE_KIDNEY_INJURY"
              category: "INCLUSION"
              time_window: "36_MONTHS"
            - cluster_id: "CKD_BPH_GOUT"
              category: "INCLUSION"
            - cluster_id: "LITHIUM_MEDICATIONS"
              category: "INCLUSION"
              time_window: "6_MONTHS"
            - cluster_id: "SULFASALAZINE_MEDICATIONS"
              category: "INCLUSION"
              time_window: "6_MONTHS"
            - cluster_id: "TACROLIMUS_MEDICATIONS"
              category: "INCLUSION"
              time_window: "6_MONTHS"
            - cluster_id: "HAEMATURIA"
              category: "INCLUSION"
            - cluster_id: "UACR_TESTING"
              category: "VALIDATION"
            - cluster_id: "URINE_BLOOD_NEGATIVE"
              category: "VALIDATION"
            - cluster_id: "PROTEINURIA_FINDINGS"
              category: "VALIDATION"
            - cluster_id: "EGFR_COD_LCS"
              category: "EXCLUSION"
              time_window: "12_MONTHS"
            - cluster_id: "EGFR_COD"
              category: "EXCLUSION"
              time_window: "12_MONTHS"
          thresholds:
            - population_group: "ADULTS_17_PLUS"
              threshold_type: "MONITORING_WINDOW"
              threshold_value: "12"
              threshold_operator: "GREATER_THAN"
              threshold_unit: "months"
              description: "No eGFR monitoring in last 12 months"
              sort_order: 1
            - population_group: "ADULTS_17_PLUS"
              threshold_type: "AKI_LOOKBACK"
              threshold_value: "3"
              threshold_operator: "WITHIN"
              threshold_unit: "years"
              description: "AKI history within last 3 years"
              sort_order: 2
            - population_group: "ADULTS_17_PLUS"
              threshold_type: "MEDICATION_LOOKBACK"
              threshold_value: "6"
              threshold_operator: "WITHIN"
              threshold_unit: "months"
              description: "Lithium/nephrotoxic medications within 6 months"
              sort_order: 3
        owner:
          name: EddieDavison92
