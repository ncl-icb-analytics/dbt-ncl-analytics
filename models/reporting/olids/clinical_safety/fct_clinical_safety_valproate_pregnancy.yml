models:
  - name: fct_clinical_safety_valproate_pregnancy
    description: 'Clinical safety alert identifying individuals of child-bearing age
      with recent valproate prescriptions.

      One row per person of child-bearing age with valproate prescription within 6
      months.

      Safety Concern: Valproate has teratogenic effects and requires monitoring in
      pregnancy or potential pregnancy.

      Criteria:

      • Recent valproate prescription (within 6 months)

      • Child-bearing age (0-55 years) or pregnancy status

      Purpose: Supports clinical safety monitoring and medication reviews to prevent
      harm during pregnancy.'
    config:
      meta:
        owner:
          name: EddieDavison92
    columns:
      - name: person_id
        description: 'Unique person identifier - primary key'
        tests:
          - unique
          - not_null

      - name: age
        description: Person's current age

      - name: gender
        description: Person's gender

      - name: is_child_bearing_age_0_55
        description: Whether person is within child-bearing age range (0-55 
          years)

      - name: latest_preg_cod_date
        description: Date of most recent pregnancy code

      - name: latest_pregdel_cod_date
        description: Date of most recent pregnancy delivery code

      - name: all_preg_concept_codes
        description: All pregnancy-related concept codes

      - name: all_preg_concept_displays
        description: All pregnancy-related concept display names

      - name: all_preg_source_cluster_ids
        description: Source cluster IDs for pregnancy codes

      - name: most_recent_valproate_order_date
        description: Date of most recent valproate prescription

      - name: valproate_medication_order_id
        description: Medication order ID for valproate prescription

      - name: valproate_medication_statement_id
        description: Medication statement ID for valproate

      - name: valproate_order_medication_name
        description: Name of ordered valproate medication

      - name: valproate_order_dose
        description: Prescribed dose of valproate

      - name: valproate_order_quantity_value
        description: Quantity value of valproate order

      - name: valproate_order_quantity_unit
        description: Unit for valproate order quantity

      - name: valproate_order_duration_days
        description: Duration in days for valproate order

      - name: valproate_statement_medication_name
        description: Medication statement name for valproate

      - name: valproate_mapped_concept_code
        description: Mapped concept code for valproate

      - name: valproate_mapped_concept_display
        description: Mapped concept display name for valproate

      - name: valproate_product_term
        description: Product term for valproate medication

      - name: valproate_recent_order_count
        description: Count of recent valproate orders (within 6 months)
