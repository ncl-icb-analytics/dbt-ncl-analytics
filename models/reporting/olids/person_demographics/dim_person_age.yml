version: 2
models:
  - name: dim_person_age
    description: 'Person age attributes with comprehensive age bands, school stages, and life stage categories.

      Key Features:

      • One row per person with recorded birth dates

      • Current age for living persons, age at death for deceased persons

      • Multiple age band standards: 5-year, 10-year, NHS Digital, ONS

      • UK school system integration with academic year logic

      • Life stage categorisation from infant to very elderly

      • Conservative age calculation for minimum age scenarios

      Purpose: Supports demographic analysis, service planning, educational needs assessment, and age-based cohort analysis.'
    columns:
      - name: person_id
        description: Unique identifier for the person
        tests:
          - not_null
          - unique
      
      - name: birth_date_approx
        description: Approximate date of birth (mid-month)
        tests:
          - not_null
      
      - name: age
        description: Current age or age at death in years
        tests:
          - not_null
      
      - name: birth_date_approx_end_of_month
        description: 'Approximate date of birth using the last day of the recorded birth month. Complements birth_date_approx (mid-month) for scenarios that require end-of-month alignment.'
      - name: age_at_least
        description: 'Minimum possible age in full years, calculated using the last day of the recorded birth month as the date of birth. For deceased persons, this is age at death.'

      - name: age_band_5y
        description: '5-year age bands (0-4, 5-9, 10-14, ..., 80-84, 85+)'

      - name: age_band_10y
        description: '10-year age bands (0-9, 10-19, 20-29, ..., 70-79, 80+)'

      - name: age_band_nhs
        description: 'NHS Digital age bands (0-4, 5-14, 15-24, 25-34, 35-44, 45-54, 55-64, 65-74, 75-84, 85+)'

      - name: age_band_ons
        description: 'ONS age bands (0-4, 5-9, 10-14, 15-19, 20-24, 25-29, ..., 80-84, 85+)'

      - name: age_life_stage
        description: 'Life stage categories (Infant, Toddler, Child, Adolescent, Young Adult, Adult, Senior, Elderly, Very Elderly)'

      - name: age_months
        description: 'Age in months (precise calculation)'

      - name: age_weeks_approx
        description: 'Age in weeks (approximate calculation)'

      - name: age_days_approx
        description: 'Age in days (approximate calculation)'

      - name: age_school_stage
        description: 'School year classification (Pre-school, Nursery, Reception, Year 1-13, Post-secondary)'

      - name: age_education_level
        description: 'Education level classification (Pre-school, Nursery, Primary School, Secondary School - KS3/KS4, Secondary School - Sixth Form, Post-secondary)'

      - name: is_primary_school_age
        description: 'Flag indicating primary school age (Reception to Year 6)'
        tests:
          - not_null

      - name: is_secondary_school_age
        description: 'Flag indicating secondary school age (Year 7 to Year 13)'
        tests:
          - not_null
