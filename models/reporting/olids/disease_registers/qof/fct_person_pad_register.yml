version: 2
models:
  - name: fct_person_pad_register
    description: 'QOF peripheral arterial disease register for patients with peripheral
      vascular disease.

      One row per person with PAD_COD present (PAD is permanent condition).'

    tests:
      - dbt_utils.at_least_one:
          column_name: person_id

    columns:
      - name: person_id
        description: Unique identifier for the person
        tests:
          - unique
          - not_null

    config:
      meta:
        indicator:
          id: "PAD002"
          type: "CONDITION"
          category: "LTC"
          clinical_domain: "Cardiovascular"
          name_short: "Peripheral Arterial Disease"
          description_short: "QOF peripheral arterial disease register"
          description_long: >
            Peripheral arterial disease diagnosed using QOF criteria: Any PAD diagnosis
            code  qualifies for register inclusion. PAD is considered a permanent
            condition with no  resolution codes. Used for cardiovascular risk management
            and secondary prevention.  Maps to QOF indicator PAD002 (PAD Register).
            Uses PAD_COD for diagnosis codes.
          is_qof: true
          qof_indicator: "PAD002"
          source_column: "is_on_register"
          usage_contexts:
            - "POPULATION_HEALTH_NEEDS_DASHBOARD"
            - "QOF"
          code_clusters:
            - cluster_id: "PAD_COD"
              category: "INCLUSION"
        owner:
          name: EddieDavison92
