# Source Database and Schema Mappings for NCL Analytics
# This file defines how source databases/schemas map to dbt sources
# Supports both OLIDS and Commissioning data sources
# 
# Structure:
#   - source_name: Name used in dbt source() references
#     database: Source database name
#     schema: Source schema name (optional - if omitted, all schemas in database)
#     description: What this data source contains
#     staging_prefix: Prefix for staging models (optional, defaults to stg_{source_name})
#     domain: Which domain folder to create staging models in (commissioning, olids, shared)

version: 1

sources:
  # ========================================
  # COMMISSIONING DATA SOURCES
  # ========================================
  
  # Waiting Lists Data
  - source_name: wl
    database: DATA_LAKE
    schema: WL
    description: Waiting lists and patient pathway data
    staging_prefix: stg_wl
    domain: commissioning
    
  # SUS Unified - Outpatient
  - source_name: sus_op
    database: DATA_LAKE
    schema: SUS_UNIFIED_OP
    description: SUS outpatient appointments and activity
    staging_prefix: stg_sus_op
    domain: commissioning
    
  # SUS Unified - Admitted Patient Care
  - source_name: sus_apc
    database: DATA_LAKE
    schema: SUS_UNIFIED_APC
    description: SUS admitted patient care episodes and procedures
    staging_prefix: stg_sus_apc
    domain: commissioning
  
   # SUS Unified - Emergency Care
  - source_name: sus_ae
    database: DATA_LAKE
    schema: SUS_UNIFIED_ECDS
    description: SUS emergency care attendances and activity
    staging_prefix: stg_sus_ae
    domain: commissioning

  # eRS referrals
  - source_name: eRS_primary_care
    database: DATA_LAKE
    schema: ERS
    description: Primary care referrals data
    staging_prefix: stg_ers_pc
    domain: commissioning

  # EPD Primary Care
  - source_name: epd_primary_care
    database: DATA_LAKE
    schema: EPD_PRIMARY_CARE
    description: Primary care medications and prescribing data
    staging_prefix: stg_epd_pc
    domain: commissioning
  
  # Dictionary/Reference Data dbo
  - source_name: dictionary_dbo
    database: Dictionary
    schema: dbo
    description: Reference data including PDS and lookup tables
    staging_prefix: stg_dictionary_dbo
    domain: shared

  # Dictionary/Reference Data ECDS_ETOS
  - source_name: dictionary_ecds
    database: Dictionary
    schema: ECDS_ETOS
    description: Reference data for ECDS
    staging_prefix: stg_dictionary_ecds
    domain: shared

  # Dictionary/Reference Data OP
  - source_name: dictionary_op
    database: Dictionary
    schema: OP
    description: Reference data for outpatient procedures and treatments
    staging_prefix: stg_dictionary_op
    domain: shared

    # Dictionary/Reference Data IP
  - source_name: dictionary_ip
    database: Dictionary
    schema: IP
    description: Reference data for inpatient procedures and treatments
    staging_prefix: stg_dictionary_ip
    domain: shared

  # ========================================
  # OLIDS DATA SOURCES
  # ========================================

  # OLIDS Core Tables
  - source_name: olids
    database: DATA_LAKE
    schema: OLIDS
    description: OLIDS stable layer - cleaned and filtered patient records
    staging_prefix: stg_olids
    domain: olids

  # Dictionary/Reference Data SNOMED
  - source_name: dictionary_snomed
    database: Dictionary
    schema: Snomed
    description: Reference data for snomed
    staging_prefix: stg_dictionary_snomed
    domain: shared

  # eRS dictionary
  - source_name: dictionary_eRS
    database: Dictionary
    schema: E-Referral
    description: Primary care referrals lookups
    staging_prefix: stg_dictionary_ers
    domain: shared

  # Community services dataset
  - source_name: csds
    database: DATA_LAKE
    schema: CSDS
    description: Community services dataset
    staging_prefix: stg_csds
    domain: commissioning
  # ========================================
  # DATA_LAKE__NCL REFERENCE DATA SOURCES
  # ========================================

  # TERMINOLOGY schema in DATA_LAKE__NCL
  - source_name: reference_terminology
    database: DATA_LAKE__NCL
    schema: TERMINOLOGY
    description: Reference terminology data including SNOMED, BNF, and other code sets
    staging_prefix: stg_reference
    domain: shared

  # ANALYST_MANAGED schema in DATA_LAKE__NCL
  - source_name: reference_analyst_managed
    database: DATA_LAKE__NCL
    schema: ANALYST_MANAGED
    description: Analyst-managed reference datasets and business rules
    staging_prefix: stg_reference
    domain: shared

  # DATA_MANAGEMENT schema in DATA_LAKE__NCL
  - source_name: reference_data_management
    database: DATA_LAKE__NCL
    schema: DATA_MANAGEMENT
    description: Data management reference datasets
    staging_prefix: stg_reference
    domain: shared

  # CANCER schemas in DATA_LAKE__NCL
  - source_name: reference_cancer_cwt_alliance
    database: DATA_LAKE__NCL
    schema: CANCER__CWT_ALLIANCE
    description: Cancer waiting times alliance data
    staging_prefix: stg_reference
    domain: shared

  - source_name: reference_cancer_emis
    database: DATA_LAKE__NCL
    schema: CANCER__EMIS
    description: Cancer EMIS data
    staging_prefix: stg_reference
    domain: shared

  - source_name: reference_cancer_screening
    database: DATA_LAKE__NCL
    schema: CANCER__SCREENING
    description: Cancer screening data
    staging_prefix: stg_reference
    domain: shared

  # Fingertips schema in DATA_LAKE__NCL
  - source_name: reference_fingertips
    database: DATA_LAKE__NCL
    schema: FINGERTIPS
    description: Fingertips indicator data
    staging_prefix: stg_reference
    domain: shared

  # Phenolab schema in DATA_LAKE__NCL
  - source_name: phenolab
    database: DATA_LAKE__NCL
    schema: PHENOLAB_DEV
    description: Phenolab supporting data
    staging_prefix: stg_reference
    domain: phenolab

  # ========================================
  # ADDITIONAL OLIDS DATA SOURCES
  # ========================================
  # Additional OLIDS sources can be added here if needed