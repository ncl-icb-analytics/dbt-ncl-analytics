version: 2

macros:
  - name: apply_snowflake_tag_if_tagged
    description: >
      Applies a Snowflake tag to a model if it has a specific dbt tag.
      Used in post-hooks to conditionally apply governance tags.


      Usage:

      ```yaml

      # In dbt_project.yml:
      models:
        +post-hook:
          - "{{ apply_snowflake_tag_if_tagged('secondary_use_opt_out', 'DATA_CATEGORY', 'PRIMARY_CARE_SECONDARY_USE') }}"

      ```
    arguments:
      - name: dbt_tag
        type: string
        description: dbt tag to check for on the model

      - name: sf_tag_name
        type: string
        description: Snowflake tag name to apply

      - name: sf_tag_value
        type: string
        description: Value to set for the Snowflake tag
