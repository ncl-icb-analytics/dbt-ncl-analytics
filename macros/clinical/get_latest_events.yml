version: 2

macros:
  - name: get_latest_events
    description: >
      Returns the most recent event per partition using Snowflake QUALIFY.


    arguments:
      - name: from_table
        type: string
        description: Source table or CTE to select from

      - name: partition_by
        type: string | list
        description: Column(s) to partition by. Default 'person_id'

      - name: order_by
        type: string | list
        description: Column(s) to order by within partition. Default 'clinical_effective_date'

      - name: direction
        type: string
        description: Sort direction (ASC or DESC). Default 'DESC'
