version: 2

macros:
  - name: filter_by_date
    description: >
      Generates date filter conditions. Supports relative dates (months/years back) or absolute date ranges.


      Usage:

      ```sql

      WHERE {{ filter_by_date('event_date', months_back=6) }}

      WHERE {{ filter_by_date('created_at', years_back=2) }}

      WHERE {{ filter_by_date('order_date', start_date='2024-01-01', end_date='2024-12-31') }}

      WHERE {{ filter_by_date('admission_date', start_date='2024-01-01') }}

      ```
    arguments:
      - name: date_column
        type: string
        description: Date column to filter on

      - name: months_back
        type: integer
        description: Filter to last N months from today

      - name: years_back
        type: integer
        description: Filter to last N years from today

      - name: start_date
        type: string
        description: Start date for range filter (YYYY-MM-DD)

      - name: end_date
        type: string
        description: End date for range filter (YYYY-MM-DD)
